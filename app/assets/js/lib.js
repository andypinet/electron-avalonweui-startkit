!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.avalon=t():e.avalon=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r=n(84);n(8),n(15),n(86),n(95),n(72),n(103),n(104),e.exports=r},,,function(e,t){(function(t){function n(e){return new n.init(e)}t.avalon=n,"undefined"!=typeof window&&(window.avalon=n),n.init=function(e){this[0]=this.element=e},n.fn=n.prototype=n.init.prototype,n.shadowCopy=function(e,t){for(var n in t)e[n]=t[n];return e};var r=/[^, ]+/g,a=t.console;n.shadowCopy(n,{noop:function(){},rword:r,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,log:function(){a&&n.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(a&&n.config.debug){var e=console.warn||console.log;Function.apply.call(e,console,arguments)}},error:function(e,t){throw(t||Error)(e)},oneObject:function(e,t){"string"==typeof e&&(e=e.match(r)||[]);for(var n={},a=void 0!==t?t:1,o=0,i=e.length;i>o;o++)n[e[o]]=a;return n}}),e.exports=n}).call(t,function(){return this}())},function(e,t){(function(t){var n=t,r={window:n,document:{createElement:function(){return{}},createElementNS:function(){return{}},contains:Boolean},root:{outerHTML:"x"},msie:NaN,modern:!0,avalonDiv:{},avalonFragment:null};if(n.location&&n.navigator&&n.window){var a=n.document;r.document=a,r.modern=n.dispatchEvent,r.root=a.documentElement,r.avalonDiv=a.createElement("div"),r.avalonFragment=a.createDocumentFragment(),n.VBArray&&(r.msie=a.documentMode||(n.XMLHttpRequest?7:6))}e.exports=r}).call(t,function(){return this}())},,function(e,t){function n(e,t,n){e[n.name]=avalon.parseExpr(n)}var r={},a=/([a-z\d])([A-Z]+)/g,o=/[-_][^-_]/g,i=/\d\.\d{4}/,s=/[-.*+?^${}()|[\]\/\\]/g,l=[].slice;avalon.shadowCopy(avalon,{caches:{},vmodels:{},filters:{},components:{},directives:{},eventHooks:{},eventListeners:{},validators:{},scopes:{},cssHooks:r,parsers:{number:function(e){return""===e?"":parseFloat(e)||0},string:function(e){return null===e||void 0===e?"":e+""},"boolean":function(e){return"true"===e}},version:"2.07",slice:function(e,t,n){return l.call(e,t,n)},css:function(e,t,n,a){e instanceof avalon&&(e=e[0]);var o=avalon.camelize(t);if(t=avalon.cssName(o)||o,void 0===n||"boolean"==typeof n){a=r[o+":get"]||r["@:get"],"background"===t&&(t="backgroundColor");var i=a(e,t);return n===!0?parseFloat(i)||0:i}if(""===n)e.style[t]="";else{if(null==n||n!==n)return;isFinite(n)&&!avalon.cssNumber[o]&&(n+="px"),a=r[o+":set"]||r["@:set"],a(e,t,n)}},directive:function(e,t){return t.parse=t.parse||n,this.directives[e]=t},isObject:function(e){return null!==e&&"object"==typeof e},range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n)),o=new Array(a);++r<a;)o[r]=e,e+=n;return o},hyphen:function(e){return e.replace(a,"$1-$2").toLowerCase()},camelize:function(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(o,function(e){return e.charAt(1).toUpperCase()})},makeHashCode:function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(i,e)},escapeRegExp:function(e){return(e+"").replace(s,"\\$&")},Array:{merge:function(e,t){e.push.apply(e,t)},ensure:function(e,t){return-1===e.indexOf(t)?e.push(t):void 0},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return~n?avalon.Array.removeAt(e,n):!1}}}),"undefined"!=typeof performance&&performance.now&&(avalon.makeHashCode=function(e){return e=e||"avalon",(e+performance.now()).replace(".","")});var c=1;e.exports={avalon:avalon,getLongID:function(e){return e.uuid||(e.uuid=avalon.makeHashCode("e"))},getShortID:function(e){return e.uuid||(e.uuid="_"+ ++c)}}},function(e,t){function n(e){for(var t in e)if(avalon.ohasOwn.call(e,t)){var r=e[t];"function"==typeof n.plugins[t]?n.plugins[t](r):"object"==typeof n[t]?avalon.shadowCopy(n[t],r):n[t]=r}return this}avalon.config=n;var r={interpolate:function(e){var t=e[0],r=e[1];if(t===r)throw new SyntaxError("openTag!==closeTag");var a=t+"test"+r,o=avalon.avalonDiv;if(o.innerHTML=a,o.innerHTML!==a&&o.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");o.innerHTML="",n.openTag=t,n.closeTag=r;var i=avalon.escapeRegExp(t),s=avalon.escapeRegExp(r);n.rexpr=new RegExp(i+"([\\ss\\S]*)"+s),n.rexprg=new RegExp(i+"([\\ss\\S]*)"+s,"g"),n.rbind=new RegExp(i+"[\\ss\\S]*"+s+"|\\bms-|\\bslot\\b")}};n.plugins=r,avalon.config({interpolate:["{{","}}"],debug:!0})},function(e,t,n){function r(e){return e}var a=n(9),o=n(10),i=n(11),s=n(12),l=n(13),c=n(14),u=avalon.filters;avalon.__format__=function(e){var t=u[e];return t?t.get?t.get:t:r},avalon.mix(u,{uppercase:function(e){return String(e).toUpperCase()},lowercase:function(e){return String(e).toLowerCase()},truncate:function(e,t,n){return t=t||30,n="string"==typeof n?n:"...",e.length>t?e.slice(0,t-n.length)+n:String(e)},camelize:avalon.camelize,date:s,escape:o,sanitize:i,number:a,currency:function(e,t,n){return(t||"￥")+a(e,isFinite(n)?n:2)}},l,c),e.exports=avalon},function(e,t){function n(e,t,n,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):3,i=r||",",s=n||".",l="",c=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};return l=(o?c(a,o):""+Math.round(a)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(l[1]||"").length<o&&(l[1]=l[1]||"",l[1]+=new Array(o-l[1].length+1).join("0")),l.join(s)}e.exports=n},function(e,t){function n(e){return String(e).replace(/&/g,"&amp;").replace(r,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(a,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var r=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,a=/([^\#-~| |!])/g;e.exports=n},function(e,t){var n=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,r=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,a=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,o={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi};e.exports=function(e){return e.replace(n,"").replace(a,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var a=o[n[1]];a&&(e=e.replace(a,function(e,t,n){var r=n.charAt(0);return t+"="+r+"javascript:void(0)"+r}))}return e.replace(r," ").replace(/\s+/g," ")})}},function(e,t){function n(e){return parseInt(e,10)||0}function r(e,t,n){var r="";for(0>e&&(r="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function a(e,t,n,a){return function(o){var i=o["get"+e]();return(n>0||i>-n)&&(i+=n),0===i&&-12===n&&(i=12),r(i,t,a)}}function o(e,t){return function(n,r){var a=n["get"+e](),o=(t?"SHORT"+e:e).toUpperCase();return r[o][a]}}function i(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=r(Math[t>0?"floor":"ceil"](t/60),2)+r(Math.abs(t%60),2)}function s(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function l(e,t){var r,a,o=l.locate,i="",s=[];if(t=t||"mediumDate",t=o[t]||t,"string"==typeof e)if(/^\d+$/.test(e))e=n(e);else if(p.test(e))e=+RegExp.$1;else{var f=e.trim(),d=[0,0,0,0,0,0,0],v=new Date(0);f=f.replace(/^(\d+)\D(\d+)\D(\d+)/,function(e,t,r,a){var o=4===a.length?[a,t,r]:[t,r,a];return d[0]=n(o[0]),d[1]=n(o[1])-1,d[2]=n(o[2]),""});var h=v.setFullYear,m=v.setHours;f=f.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(e,t,r,a,o){return d[3]=n(t),d[4]=n(r),d[5]=n(a),o&&(d[6]=Math.round(1e3*parseFloat("0."+o))),""});var g=0,y=0;f=f.replace(/Z|([+-])(\d\d):?(\d\d)/,function(e,t,r,a){return h=v.setUTCFullYear,m=v.setUTCHours,t&&(g=n(t+r),y=n(t+a)),""}),d[3]-=g,d[4]-=y,h.apply(v,d.slice(0,3)),m.apply(v,d.slice(3)),e=v}if("number"==typeof e&&(e=new Date(e)),"date"===avalon.type(e)){for(;t;)a=u.exec(t),a?(s=s.concat(a.slice(1)),t=s.pop()):(s.push(t),t=null);return s.forEach(function(t){r=c[t],i+=r?r(e,o):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}}var c={yyyy:a("FullYear",4),yy:a("FullYear",2,0,!0),y:a("FullYear",1),MMMM:o("Month"),MMM:o("Month",!0),MM:a("Month",2,1),M:a("Month",1,1),dd:a("Date",2),d:a("Date",1),HH:a("Hours",2),H:a("Hours",1),hh:a("Hours",2,-12),h:a("Hours",1,-12),mm:a("Minutes",2),m:a("Minutes",1),ss:a("Seconds",2),s:a("Seconds",1),sss:a("Milliseconds",3),EEEE:o("Day"),EEE:o("Day",!0),a:s,Z:i},u=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,p=/^\/Date\((\d+)\)\/$/,f={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};f.SHORTMONTH=f.MONTH,l.locate=f,e.exports=l},function(e,t){function n(e,t,n){var r=avalon.type(e);if("array"!==r&&"object"!==r)throw"orderBy只能处理对象或数组";var a=n&&0>n?-1:1;if("string"==typeof t){var o=t;t=function(e){return e&&e[o]}}e=s(e),e.forEach(function(e){e.order=t(e.value,e.key)}),e.sort(function(e,t){var n=e.order,r=t.order;return Number.isNaN(n)&&Number.isNaN(r)?0:n===r?0:n>r?a:-a});var l="array"===r,c=l?[]:{};return i(c,e,function(e){l?c.push(e.value):c[e.key]=e.value})}function r(e,t){var n=avalon.type(e);if("array"!==n&&"object"!==n)throw"filterBy只能处理对象或数组";var r=avalon.slice(arguments,2),a=avalon.type(t);if("function"===a)var o=t;else{if("string"!==a&&"number"!==a)return e;if(""===t)return e;var l=new RegExp(avalon.escapeRegExp(t),"i");o=function(e){return l.test(e)}}e=s(e).filter(function(e,t){return!!o.apply(e,[e.value,t].concat(r))});var c="array"===n,u=c?[]:{};return i(u,e,function(e){c?u.push(e.value):u[e.key]=e.value})}function a(e,t,n){if(avalon.isObject(e)&&!Array.isArray(e)){var r=[];return i(r,t,function(t){r.push(e.hasOwnProperty(t)?e[t]:n?n[t]:"")})}return e}function o(e,t,n){var r=avalon.type(e);if("array"!==r&&"object"!==r)throw"limitBy只能处理对象或数组";if(t=Math.abs(Number(t))===1/0?Number(t):parseInt(t,10),Number.isNaN(t))return e;"object"===r&&(e=s(e)),t=Math.min(e.length,t),n=!n||Number.isNaN(n)?0:~~n,0>n&&(n=Math.max(0,e.length+n));for(var a=[],o=n;t>o;o++)a.push(e[o]);var l="array"===r;if(l)return a;var c={};return i(c,a,function(e){c[e.key]=e.value})}function i(e,t,n){for(var r=0,a=t.length;a>r;r++)n(t[r]);return e}function s(e){var t=[],n=0;return avalon.each(e,function(e,r){t[n++]={value:r,key:e}}),t}Number.isNaN=Number.isNaN||function(e){return e!==e},e.exports={limitBy:o,orderBy:n,selectBy:a,filterBy:r}},function(e,t){var n={stop:function(e){return e.stopPropagation(),e},prevent:function(e){return e.preventDefault(),e}},r={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};avalon.each(r,function(e,t){n[e]=function(e){return e.which!==t&&(e.$return=!0),e}}),e.exports=n},function(e,t,n){var r=n(16),a=n(17),o=n(18);avalon.vdomAdaptor=function(e,t){if(!e)return"toHTML"===t?"":avalon.avalonFragment.cloneNode(!1);switch(e.nodeType){case 3:return r.prototype[t].call(e);case 8:return a.prototype[t].call(e);default:return o.prototype[t].call(e)}},e.exports={VText:r,VComment:a,VElement:o}},function(e,t){function n(e){if("string"==typeof e)this.type="#text",this.nodeValue=e,this.skipContent=!r.test(e),this.nodeType=3;else for(var t in e)this[t]=e[t]}var r=avalon.config.rexpr;n.prototype={constructor:n,toDOM:function(){return document.createTextNode(this.nodeValue)},toHTML:function(){return this.nodeValue}},e.exports=n},function(e,t){function n(e){if("string"==typeof e)this.type="#comment",this.nodeValue=e,this.skipContent=!0,this.nodeType=8;else for(var t in e)this[t]=e[t]}n.prototype={constructor:n,toDOM:function(){return document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"}},e.exports=n},function(e,t){function n(e,t,n){if("object"==typeof e)for(var r in e)this[r]=e[r];else this.nodeType=1,this.type=e,this.props=t,this.children=n,this.template=""}function r(e){return e!==!1&&Object(e)!==e}function a(e){document.styleSheets.length<31?document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):document.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");var t=e.split(":");1===t.length&&t.unshift("v");var n=t[1],r=t[0];return document.namespaces[r]||document.namespaces.add(r,"urn:schemas-microsoft-com:vml"),document.createElement("<"+r+":"+n+' class="rvml">')}function o(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}var i={"class":function(e,t){e.className=t},style:function(e,t){e.style.cssText=t},"for":function(e,t){e.htmlFor=t}},s=avalon.oneObject("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use,g,svg"),l=(avalon.oneObject("shape,line,polyline,rect,roundrect,oval,arc,curve,background,image,shapetype,group,fill,stroke,shadow, extrusion, textbox, imagedata, textpath"),/^\w+\:\w+/);n.prototype={constructor:n,toDOM:function(){var e,t=this.type;e=avalon.modern&&s[t]?o(t):avalon.modern||!VMLTag(t)&&!l.test(t)?document.createElement(t):a(t);for(var n in this.props){var c=this.props[n];r(c)&&(i[n]&&avalon.msie<8?i[n](e,c):e.setAttribute(n,c+""))}if(this.wid){var u=avalon.scopes[this.wid];if(u&&u.dom)return u.dom}if(this.skipContent)switch(this.type){case"script":e.text=this.template;break;case"style":case"template":e.innerHTML=this.template;break;case"noscript":e.textContent=this.template;break;default:var p=avalon.parseHTML(this.template);e.appendChild(p)}else this.isVoidTag||(this.children.length?this.children.forEach(function(t){t&&e.appendChild(avalon.vdomAdaptor(t,"toDOM"))}):e.appendChild(avalon.parseHTML(this.template)));return e},toHTML:function(){var e=[];for(var t in this.props){var n=this.props[t];r(n)&&e.push(t+"="+avalon.quote(this.props[t]+""))}e=e.length?" "+e.join(" "):"";var a="<"+this.type+e;return this.isVoidTag?a+"/>":(a+=">",a+=this.children.length?this.children.map(function(e){return e?avalon.vdomAdaptor(e,"toHTML"):""}).join(""):this.template,a+"</"+this.type+">")}},e.exports=n},,,,,function(e,t){var n={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},r=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");r.replace(/\w+/g,function(e){n[e.toLowerCase()]=e});var a=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");a.replace(/\w+/g,function(e){n[e.toLowerCase()]=e}),e.exports=n},,,,,function(e,t){function n(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var r=n.prototype;r.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},r.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0,delete this._keymap[e.key])},r.get=function(e){var t=this._keymap[e];if(void 0!==t)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)},e.exports=n},function(e,t){function n(e){var t="undefined"!=typeof e.querySelectorAll?e.querySelectorAll("script"):e.getElementsByTagName("script");if(t.length)for(var n,o=0;n=t[o++];)if(a[n.type]){var i=r.cloneNode(!1);Array.prototype.forEach.call(n.attributes,function(e){e&&e.specified&&(i[e.name]=e.value,i.setAttribute(e.name,e.value))}),i.text=n.text,n.parentNode.replaceChild(i,n)}}var r=avalon.document.createElement("script"),a=avalon.oneObject(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]);e.exports=n},,,,function(e,t){e.exports={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0}},,function(e,t){function n(e,t){for(var i,s=0;i=e[s++];)if(1===i.nodeType){var l=a(i);l&&++o;var c=avalon.vmodels[l];if(c&&!c.$element){r(i),avalon(i).removeClass("ms-controller"),c.$element=i;var u=new Date;i.vtree=avalon.lexer(i.outerHTML.trim());var p=new Date;avalon.log("create primitive vtree",p-u),c.$render=avalon.render(i.vtree),avalon.scopes[c.$id]={vmodel:c,local:{},dom:i,render:c.$render};var f=new Date;avalon.log("create template Function ",f-p),avalon.rerenderStart=f,avalon.batch(l,!0),"function"==typeof t&&t(c)}else l||n(i.childNodes,t)}}function r(e){for(var t,n=0;n<e.childNodes.length;n++){var a=e.childNodes[n];3!==a.nodeType||i.test(a.nodeValue)?1===a.nodeType&&r(a):(t=e.removeChild(a),n--)}0===e.childNodes.length&&t&&e.appendChild(t)}function a(e){return e.getAttribute("ms-controller")||e.getAttribute("ms-important")}var o=0,i=/\S/;e.exports=avalon.scan=function(e,t){return e&&e.nodeType?(n([e],t),void(o=0)):void avalon.warn("[avalon.scan] first argument must be element , documentFragment, or document")}},,function(e,t,n){var r=n(38);avalon.directive("important",{priority:1,parse:function(e,t,n){var r=n.expr,a=avalon.quote(r),o=n.name;e[o]=a,t.$prepend=["(function(__vmodel__){","var important = avalon.scopes["+a+"]",'if(important && important.fast){avalon.log("不进入"+'+a+");return }","var __top__ = __vmodel__","var __synth__ =  avalon.vmodels["+a+"]","var __present__ = __synth__","var __vmodel__ = __synth__","/*controller:"+r+"*/"].join("\n")+"\n\n",e.synth="__synth__",e.local="{}",e.top="__top__",e.present="__present__",t.$append="/*controller:"+r+"*/\n})(__vmodel__);"},diff:function(e,t,n,a){t[a]!==e[a]&&r(e,this.update,n,"controller")},update:function(e,t,n){avalon.directives.controller.update(e,t,n,"important")}})},function(e,t){e.exports=function(e,t,n,r,a){a=a||"change";var o=e[a]||(e[a]=[]);avalon.Array.ensure(o,t)&&(n.count+=1,avalon.config.showDiff&&avalon.log(r+" change"))}},function(e,t,n){var r=n(38);avalon.directive("controller",{priority:2,parse:function(e,t,n){var r=n.expr,a=avalon.quote(r),o=n.name;e[o]=a,t.$prepend=["(function(__vmodel__){","var __top__ = __vmodel__","var __present__ = avalon.vmodels["+a+"]","if(__present__ && __top__ && __present__ !== __top__){","var __synth__ =  avalon.mediatorFactory(__vmodel__, __present__)","var __vmodel__ = __synth__","}else{","__vmodel__ = __top__ || __present__","}","/*controller:"+r+"*/"].join("\n")+"\n\n",e.synth="__synth__",e.local="__local__",e.top="__top__",e.present="__present__",t.$append="/*controller:"+r+"*/\n})(__vmodel__);"},diff:function(e,t,n,a){t[a]!==e[a]&&r(e,this.update,n,"controller")},update:function(e,t,n,r){var a=t.top,o=t.present,i=t.synth;if(a===o){if(void 0===a)return;var s=avalon.scopes[a.$id];if(s&&(!r||r.fast))return}if(a&&o){var l=a.$render+"",c="/*controller:"+o.$id+"*/",u=l.indexOf(c)+c.length,p=l.lastIndexOf(c),f=l.slice(u,p),d=t.local||{},v=[];for(var h in d)v.push("var "+h+" = __local__["+avalon.quote(h)+"]");v.push("var vnodes = []");var m=v.join("\n")+f+"\nreturn vnodes",g=avalon.render(m);i.$render=o.$render=g,i.$element=o.$element=e,avalon.scopes[o.$id]={vmodel:o,synth:i,local:d,dom:e,render:g,fast:"important"}}}})},,function(e,t,n){var r=n(38);avalon.directive("css",{diff:function(e,t,n,a){var o=e[a],i=t[a];if(Object(o)===o){if(o=o.$model||o,Array.isArray(o)&&(o=e[a]=avalon.mix.apply({},o)),"object"!=typeof i)e.changeStyle=o;else{var s={},l=!1;for(var c in o)o[c]!==i[c]&&(l=!0,s[c]=o[c]);l&&(e.changeStyle=s)}e.changeStyle&&r(e,this.update,n,"css")}else e[a]=i},update:function(e,t){var n=t.changeStyle,r=avalon(e);for(var a in n)r.css(a,n[a]);delete t.changeStyle}})},function(e,t,n){function r(e,t){var n=e.ownerDocument,a=e.nodeName,i="_"+a;if(!r[i]){var s=n.body.appendChild(n.createElement(a));t=avalon.modern?getComputedStyle(s,null).display:s.currentStyle.display,n.body.removeChild(s),t===o&&(t="block"),r[i]=t}return r[i]}var a=n(38),o="none";avalon.parseDisplay=r,avalon.directive("visible",{diff:function(e,t,n,r){var o=e[r]=!!e[r];e.displayValue=t.displayValue,o!==t.props[r]&&a(e,this.update,n,"visible")},update:function(e,t){function n(){void 0!==a&&(e.style.display=a)}var a,i=t["ms-visible"],s=e.style.display;i?(s===o&&(a=t.displayValue,a||(e.style.display="")),""===e.style.display&&avalon(e).css("display")===o&&avalon.contains(e.ownerDocument,e)&&(a=r(e))):s!==o&&(a=o,t.displayValue=s),avalon.applyEffect(e,t,{hook:i?"onEnterDone":"onLeaveDone",cb:n})}})},,function(e,t,n){var r=n(45).ident,a=n(38);avalon.directive("text",{parse:function(e,t,n){e.children="[]",e.skipContent=!0;var a=r.test(n.expr)?n.expr:avalon.parseExpr(n);e[n.name]=a},diff:function(e,t,n,r){var o=e[r],i=t[r];e.children=t.children;var s=e.dom=t.dom;return o===i&&0!==e.children.length||(e.children[0]||(e.children[0]={type:"#text",nodeType:3}),e.children[0].nodeValue=o,s?this.update(s,e):a(e,this.update,n,"text")),t.dom=null,!1},update:function(e,t){var n=t["ms-text"];"textContent"in e?e.textContent=n+"":e.innerText=n+"",t.dom=e}})},function(e,t){e.exports={ident:/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,sp:/^\s+$/,leftSp:/^\s+/,rightSp:/s+$/,binding:/^ms-(\w+)-?(.*)/,string:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/g}},function(e,t,n){var r=n(38);n(47);avalon.htmlFactory=function(e,t,n){var r=avalon.lexer(e+""),a=avalon.render(r);return a(t,n)},avalon.directive("html",{parse:function(e,t,n){t.isVoidTag?e.children="[]":(e[n.name]=avalon.parseExpr(n),delete t.children,e.children="avalon.htmlFactory("+avalon.parseExpr(n)+",__vmodel__,__local__)")},diff:function(e,t,n,a){var o=e[a],i=t[a];o!==i&&r(e,this.update,n,"html")},update:function(e,t){if(1===e.nodeType){avalon.clearHTML(e);var n=document.createDocumentFragment();t.children.forEach(function(e){e&&n.appendChild(avalon.vdomAdaptor(e,"toDOM"))}),e.appendChild(n)}}})},function(e,t,n){function r(e){return m.test(e)?e:c(e,"text")}function a(e){return"vnodes.push("+e+");"}function o(e){return a(f(e))}function i(e){for(var t,n=["\nvar vnodes = [];"],r=[],a=0;t=e[a++];){var o=s(t,r);t.$prepend&&n.push(t.$prepend);var i=t.$append;delete t.$append,delete t.$prepend,o&&n.push(o+"\n"),i&&n.push(i)}return n.push("return vnodes\n"),n.join("\n")}function s(e,t,n){var r=avalon.directives;if(3===e.nodeType)return d.rexpr.test(e.nodeValue)?a(l(e)):o(e);if(1===e.nodeType){var s=e.props;0===e.type.indexOf("ms-")&&(s["ms-widget"]||(s["ms-widget"]="{is:"+v(e.type)+"}"));var p={props:{},type:e.type,nodeType:1,template:""},f=u(p,s);if(f.length||(p.skipAttrs=!0),p.order=f.map(function(t){return r[t.type].parse(p,e,t),t.name}).join(";;"),"widget"===e.directive&&(p.order=p.order?"ms-widget;;"+p.order:"ms-widget",p.directive="widget",p.local="__local__",p.vmodel="__vmodel__",p.wid=avalon.quote(e.props.wid),delete p.skipAttrs),e.isVoidTag)p.isVoidTag=!0;else if(!("children"in p)){var h=e.children;h.length?p.children="(function(){"+i(h)+"})()":(p.template=e.template,p.children="[]")}return o(p)}if(8===e.nodeType){var m=e.nodeValue;if(g.test(m)){0!==m.indexOf("ms-for:")&&avalon.error("ms-for指令前不能有空格"),t.push(e);var p=avalon.mix({directive:"for",vmodel:"__vmodel__"},e);return r["for"].parse(p,e,e),o(p)}if(y.test(m)){var w=t[t.length-1],b=w.signature;return 0!==m.indexOf("ms-for-end:")&&avalon.error("ms-for-end指令前不能有空格"),e.$append=o({nodeType:8,type:"#comment",nodeValue:b,key:"traceKey"})+"\n\n})",t.length&&(e.$append+="\n"+b+".end ="+o({nodeType:8,type:"#comment",signature:b,nodeValue:"ms-for-end:"})+"\n",t.pop()),""}if(0===m.indexOf("ms-js:")){var x=c(m.replace("ms-js:",""),"js")+"\n",T=o(e),E=x.match(_);return E&&E[1]?e.$append=(e.$append||"")+x+"\n__local__."+E[1]+" = "+E[1]+"\n":avalon.warn(m+" parse fail!"),T}return o(e)}}function l(e){var t=p(e.nodeValue),n="";if(1===t.length)n=r(t[0].expr);else{var a=t.map(function(e){return e.type?r(e.expr):v(e.expr)}).join(" + ");n="String("+a+")"}return'{\ntype: "#text",\nnodeType:3,\nfixIESkip: true,\nnodeValue: '+n+"\n}"}var c=n(48),u=n(50),p=n(51),f=n(52),d=avalon.config,v=avalon.quote,h=(avalon.makeHashCode,n(45)),m=h.ident,g=(h.sp,/^\s*ms\-for:/),y=/^\s*ms\-for\-end:/,_=/^\s*var\s+([$\w]+)\s*\=\s*\S+/;e.exports=i},function(e,t,n){function r(e,t){function n(e){var t="??"+y++;return _[t]=e,t}function r(e){return _[e]}var h={};if(t=t||"other","object"==typeof e&&(t=e.type,h=e,e=h.expr),"string"!=typeof e)return"";var m=e,g=o.get(t+":"+m);if(g)return g;var y=1,_={},w=e.replace(i,n).replace(s,n).replace(u,n).replace(f,"$1").split(p),b=w.shift().replace(l,r).trim();if("on"===t&&v.test(b)&&(b+="($event)"),b=b.replace(d,"$1__vmodel__."),"js"===t)return o.put(t+":"+m,b);var x=w.map(function(e){e=e.replace(l,r).replace(d,"$1__vmodel__.");var t=!1;return e=e.replace(c,function(e,n){return t=!0,/\S/.test(n)?"(__value__,"+n+");":"(__value__);"}),t||(e+="(__value__);"),e=e.replace(/(\w+)/,'avalon.__format__("$1")'),"__value__ = "+e}),T=[];if("on"===t)x=x.map(function(e){return e.replace(/__value__/g,"$event")}),x.length&&x.push("if($event.$return){\n	return;\n}"),avalon.modern||(b=b.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(e,t,n){return"__vmodel__."+t+".call(__vmodel__"+(/\S/.test(n)?","+n:"")+")"})),T=["function ms_on($event){","try{","	var __vmodel__ = this;","	"+b,"}catch(e){",a(e,t),"}","}"],x.unshift(2,0);else{if("duplex"===t){var E=["function (__vmodel__){","try{","return "+b+"\n","}catch(e){",a(e,t).replace("parse","get"),"}","}"];o.put("duplex:"+m,E.join("\n"));var C=["function (__vmodel__,__value__){","try{","	"+b+" = __value__","}catch(e){",a(e,t).replace("parse","set"),"}","}"];if(o.put("duplex:set:"+m,C.join("\n")),w.length){var A=["function (__vmodel__, __value__){","try{",x.join("\n"),"return __value__\n","}catch(e){",a(e,t).replace("parse","format"),"}","}"];o.put("duplex:format:"+m,A.join("\n"))}return o.get("duplex:"+m)}T=["(function(){","try{","var __value__ = "+b,"text"===t?"return avalon.parsers.string(__value__)":"return __value__","}catch(e){",a(e,t),'	return ""',"}","})()"],x.unshift(3,0)}return T.splice.apply(T,x),g=T.join("\n"),o.put(t+":"+m,g),g}function a(e,t){return"	avalon.warn(e, "+avalon.quote("parse "+t+" binding【 "+e+" 】fail")+")"}var o=n(49),i=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g,s=n(45).string,l=/\?\?\d+/g,c=/\(([^)]*)\)/,u=/\|\|/g,p=/\|(?=\w)/,f=/\s*(\.|\|)\s*/g,d=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,v=/^(?:\@|##)[$\w]+$/i;e.exports=avalon.parseExpr=r},function(e,t,n){var r=n(28);e.exports=new r(512)},function(e,t,n){function r(e,t){var n=[],r="ms-skip"in t,l={};for(var c in t){var u,p=t[c];if(!r&&(u=c.match(i))){var f=u[1],d=u[2]||"",v=c;if(s[f]){var h=parseFloat(d)||0;d=f,f="on"}if(v="ms-"+f+(d?"-"+d:""),c!==v&&(delete t[c],t[v]=p),o[f]){var m={type:f,param:d,name:v,expr:p,priority:o[f].priority||100*f.charCodeAt(0)};"on"===f&&(h=h||0,m.name+="-"+h,m.priority+=100*d.charCodeAt(0)+h),l[m.name]||(l[m.name]=1,n.push(m))}}else e.props[c]=t[c]}n.sort(a);for(var g,y=[],_=0;g=n[_++];){var f=g.type;if(y.type=f,y.push(g),"widget"===f)break}return y}function a(e,t){return e.priority-t.priority}var o=avalon.directives,i=n(45).binding,s=avalon.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit");e.exports=r},function(e,t,n){function r(e){for(var t,n,r=[],s=0;;){if(n=e.indexOf(i.openTag,s),-1===n)break;if(t=e.slice(s,n),0===s&&(t=t.replace(o.leftSp,"")),t&&r.push({expr:t}),s=n+i.openTag.length,n=e.indexOf(i.closeTag,s),-1===n)break;t=e.slice(s,n),t&&r.push({expr:t.replace(a,""),type:"{{}}"}),s=n+avalon.config.closeTag.length}t=e.slice(s);var l=t.replace(o.rightSp,"");return l&&r.push({expr:l.replace(/^\s+$/," ")}),r}var a=/\r?\n/g,o=n(45),i=avalon.config;e.exports=r},function(e,t){function n(e){return i.test(e)||a[e]?s(e):e}function r(e){var t=[];for(var r in e)if("props"===r){var a=[];for(var i in e.props){var l=e.props[i];"string"==typeof l&&(l=s(l)),a.push(n(i)+": "+l)}t.push("props: {"+a.join(",\n")+"}")}else if(e.hasOwnProperty(r)){var c=e[r];"string"==typeof c&&(c=o[r]?s(c):c),t.push(n(r)+":"+c)}return"{\n"+t.join(",\n")+"}"}var a=avalon.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile"),o={type:1,template:1,innerHTML:1,outerHTML:1,order:1,nodeValue:1,directive:1,signature:1,cid:1},i=/[W-]/,s=avalon.quote;e.exports=r},function(e,t,n){function r(e){return Object.keys(e).filter(function(t){return e[t]}).join(" ")}function a(e){var t=e.target;avalon(t).addClass(t.getAttribute(u[e.type])||"")}function o(e){var t=e.target,n=u[e.type];avalon(t).removeClass(t.getAttribute(n)||""),"change-active"!==n&&avalon(t).removeClass(t.getAttribute("change-active")||"")}function i(e,t){var n=e.getAttribute("old-change-class")||"",r=t["ms-class"];avalon(e).removeClass(n).addClass(r),e.setAttribute("old-change-class",r)}var s=n(6).getLongID,l=n(38),c=avalon.directives;avalon.directive("class",{diff:function(e,t,n,i){var s=i.slice(3),c=e[i],u=t[i];if(void 0===u&&(u=""),t.classEvent)e.classEvent=t.classEvent;else{var p={};"hover"===s?(p.mouseenter=a,p.mouseleave=o):"active"===s&&(e.props.tabindex=e.props.tabindex||-1,p.tabIndex=e.props.tabindex,p.mousedown=a,p.mouseup=o,p.mouseleave=o),e.classEvent=p}t.classEvent=null;var f=avalon.noop;Array.isArray(c)?f=c.map(function(e){return e&&"object"==typeof e?r(e):e?e:""}).join(" "):avalon.isObject(c)?f=r(c):c||0===c?f=String(c):c||(f=""),f=e[i]=f.trim().replace(/\s+/," "),u!==f&&(e["change-"+s]=f,l(e,this.update,n,s))},update:function(e,t){if(e&&1===e.nodeType){var n=t.classEvent;if(n){for(var r in n)"tabIndex"===r?e[r]=n[r]:avalon.bind(e,r,n[r]);t.classEvent={}}var a=["class","hover","active"];a.forEach(function(n){var r="change-"+n,a=t[r];if(void 0!==a)if("class"===n)e&&i(e,t);else{var o=e.getAttribute("change-"+n);o&&avalon(e).removeClass(o),e.setAttribute(r,a)}})}}}),c.active=c.hover=c["class"];var u={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"};s(a),s(o)},function(e,t,n){var r=n(6).getLongID,a=n(28),o=new a(128),i=(avalon.quote,n(38)),s=/^ms-on-([a-z]+)/,l=/\|.+/g,c=/((?:\@|\$|\#\#)?\w+)/g,u=n(45).string;avalon.directive("on",{priority:3e3,parse:function(e,t,n){var a=n.expr.replace(u," ").replace(l,"").match(c),i=a.every(function(e){return"@"===e.charAt(0)||"##"===e.slice(0,2)||"$event"===e});if(e.vmodel="__vmodel__",i){var s=n.expr,p=o.get(s);if(p)f=p.uuid;else{var p=Function("return "+avalon.parseExpr(n,"on"))(),f=r(p);o.put(s,p)}avalon.eventListeners[f]=p,e[n.name]="avalon.eventListeners."+f}else e[n.name]=avalon.parseExpr(n,"on")},diff:function(e,t,n,a){var o=e[a],l=t[a];if(o!==l){if("function"==typeof l&&"function"==typeof o&&l.uuid===o.uuid)return void(avalon.eventListeners[l.uuid]=o);var c=a.match(s),u=c[1],p=u+":"+r(o);e.addEvents=e.addEvents||{},e.addEvents[p]=o,i(e,this.update,n,"on")}},update:function(e,t){if(e&&!(e.nodeType>1)){var n,r,a;e._ms_context_=t.vmodel;for(n in t.addEvents)r=n.split(":").shift(),a=t.addEvents[n],avalon.bind(e,r,a);
delete t.addEvents}}})},,function(e,t){function n(e,t){var n=[];e.children.forEach(function(e){"option"===e.type?n.push(e):"optgroup"===e.type&&e.children.forEach(function(e){"option"===e.type&&n.push(e)})});var r=e.props.multiple,a={},o=null===r||void 0===r||r===!1;Array.isArray(t)?t.forEach(function(e){a[e]=1}):a[t]=1;for(var i,s=0;i=n[s++];){var l="value"in i.props?i.props.value:(i.children[0]||{nodeValue:""}).nodeValue.trim();if(i.props.selected=!!a[l],a[l]&&o)break}}e.exports=n},,function(e,t,n){function r(){var e=this,t=this.__ms_duplex__;if(!e.composing&&e.value!==t.lastViewValue){if(e.caret)try{var n=t.getCaret(e);n.start!==n.end&&n.start+1!==n.end||(t.caretPos=n)}catch(r){avalon.warn("fixCaret error",r)}if(t.debounceTime>4){var o=new Date,i=o-t.time||0;t.time=o,i>=t.debounceTime?a[t.type].call(t):(clearTimeout(t.debounceID),t.debounceID=setTimeout(function(){a[t.type].call(t)},i))}else a[t.type].call(t)}}var a=n(59);e.exports=r},function(e,t){function n(e){e.validator&&avalon.directives.validate.validate(e,!1),e.callback&&e.callback.call(e.vmodel,{type:"changed",target:e.element})}var r={input:function(e){var t=this;e=e||"value";var r=t.element[e],a=t.format(t.vmodel,r);a!==r&&(t.formatedValue=a,t.element[e]=a);var o=t.parse(a);o!==t.modelValue&&(t.set(t.vmodel,o),n(t))},radio:function(){var e=this;if(e.isChecked){var t=e.modelValue=!e.modelValue;e.set(e.vmodel,t),n(e)}else r.input.call(e)},checkbox:function(){var e=this,t=e.modelValue;Array.isArray(t)||(avalon.warn("ms-duplex应用于checkbox上要对应一个数组"),t=[t]);var r=e.element.checked?"ensure":"remove";if(t[r]){var a=e.parse(e.element.value);t[r](a),n(e)}},select:function(){var e=this,t=avalon(e.element).val();t+""!=this.modelValue+""&&(t=Array.isArray(t)?t.map(function(t){return e.parse(t)}):e.parse(t),e.modelValue=t,e.set(e.vmodel,t),n(e))},contenteditable:function(){r.input.call(this,"innerHTML")}};e.exports=r},function(e,t){function n(e){a[this.tagName].call(this,e),!this.caret&&this._ms_field_&&this._ms_field_.update.call(this)}var r=!1;try{var a={},o=HTMLInputElement.prototype,i=HTMLTextAreaElement.prototype,s=HTMLInputElement.prototype;Object.getOwnPropertyNames(s),a.INPUT=Object.getOwnPropertyDescriptor(o,"value").set,Object.defineProperty(o,"value",{set:n}),a.TEXTAREA=Object.getOwnPropertyDescriptor(i,"value").set,Object.defineProperty(i,"value",{set:n}),r=!0}catch(l){}e.exports=r},,function(e,t){e.exports=function(e,t){var n=e.__ms_duplex__,r=t["ms-rules"];if(r&&!n.validator)for(;e&&1===e.nodeType;){var a=e._ms_validator_;if(a){n.rules=r,n.validator=a,avalon.Array.ensure(a.fields,n)&&a.addField(n);break}e=e.parentNode}}},function(e,t,n){function r(){var e=this.data||{};return this.message.replace(i,function(t,n){return null==e[n]?"":e[n]})}var a=n(38),o=avalon.directive("validate",{diff:function(e,t,n,r){var i=e[r],s=t[r];if(s&&s.onError&&s.addField)e[r]=s;else if(Object(i)===i){i.$id&&(i=i.$model),e[r]=i;for(var r in o.defaults)i[r]||(i[r]=o.defaults[r]);i.fields=i.fields||[],a(e,this.update,n,"validate")}},update:function(e,t){var n=t["ms-validate"];e._ms_validator_=n,n.element=e,e.setAttribute("novalidate","novalidate"),n.validateAllInSubmit&&avalon.bind(e,"submit",function(e){e.preventDefault(),o.validateAll.call(n,n.onValidateAll)}),"function"==typeof n.onInit&&n.onInit.call(e)},validateAll:function(e){var t=this,n="function"==typeof e?e:t.onValidateAll,r=t.fields.filter(function(e){var n=e.element;return n&&!n.disabled&&t.element.contains(n)}).map(function(e){return o.validate(e,!0)}),a=[];Promise.all(r).then(function(e){for(var r,o=0;r=e[o++];)a=a.concat(r);if(t.deduplicateInValidateAll){var i={};a=a.filter(function(e){var t=e.element,n=t.uniqueID||(t.uniqueID=setTimeout("1"));return i[n]?!1:(i[n]=!0,!0)})}n.call(t.element,a)})},addField:function(e){var t=this,n=e.element;!t.validateInKeyup||e.isChanged||e.debounceTime||avalon.bind(n,"keyup",function(t){o.validate(e,0,t)}),t.validateInBlur&&avalon.bind(n,"blur",function(t){o.validate(e,0,t)}),t.resetInFocus&&avalon.bind(n,"focus",function(r){t.onReset.call(n,r,e)})},validate:function(e,t,n){var a=[],o=e.modelValue,i=e.element,s=e.validator;if(!i.disabled){for(var l in e.rules){var c=e.rules[l];if(c!==!1){var u,p,f=avalon.validators[l];a.push(new Promise(function(e,t){u=e,p=t}));var d=function(t){if(e.norequired&&""===o&&(t=!0),t)u(!0);else{var n={element:i,data:e.data,message:i.getAttribute("data-"+l+"-message")||i.getAttribute("data-message")||f.message,validateRule:l,getMessage:r};u(n)}};e.data={},e.data[l]=c,f.get(o,e,d)}}var v=[],h=Promise.all(a).then(function(e){for(var r,a=0;r=e[a++];)"object"==typeof r&&v.push(r);return t||(v.length?s.onError.call(i,v,n):s.onSuccess.call(i,v,n),s.onComplete.call(i,v,n)),v});return h}}}),i=/\\?{{([^{}]+)\}}/gm;o.defaults={addField:o.addField,onError:avalon.noop,onSuccess:avalon.noop,onComplete:avalon.noop,onReset:avalon.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}},function(e,t){function n(e){return"regexp"===avalon.type(e)}function r(e){if("string"==typeof e&&e){var t=e.split("-");if(3===t.length&&4===t[0].length){var n=~~t[0],r=~~t[1]-1,a=~~t[2],o=new Date(n,r,a);return o.getFullYear()===n&&o.getMonth()===r&&o.getDate()===a}}return!1}avalon.directive("rules",{parse:function(e,t,n){var r=n.expr;/{.+}/.test(r)&&(e[n.name]=avalon.parseExpr(n))},diff:avalon.noop});var a=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,o=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;avalon.shadowCopy(avalon.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(e,t,r){var a=t.element,o=t.data;if(!n(o.pattern)){var i=a.getAttribute("pattern");o.pattern=new RegExp("^(?:"+i+")$")}return r(o.pattern.test(e)),e}},digits:{message:"必须整数",get:function(e,t,n){return n(/^\-?\d+$/.test(e)),e}},number:{message:"必须数字",get:function(e,t,n){return n(isFinite(e)),e}},required:{message:"必须填写",get:function(e,t,n){return n(""!==e),e}},equalto:{message:"密码输入不一致",get:function(e,t,n){var r=String(t.data.equalto),a=avalon(document.getElementById(r)).val()||"";return n(e===a),e}},date:{message:"日期格式不正确",get:function(e,t,n){var a=t.data;return n("regexp"===avalon.type(a.date)?a.date.test(e):r(e)),e}},url:{message:"URL格式不正确",get:function(e,t,n){return n(o.test(e)),e}},email:{message:"email格式不正确",get:function(e,t,n){return n(a.test(e)),e}},minlength:{message:"最少输入{{minlength}}个字",get:function(e,t,n){var r=parseInt(t.data.minlength,10);return n(e.length>=r),e}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(e,t,n){var r=parseInt(t.data.maxlength,10);return n(e.length<=r),e}},min:{message:"输入值不能小于{{min}}",get:function(e,t,n){var r=parseInt(t.data.min,10);return n(parseFloat(e)>=r),e}},max:{message:"输入值不能大于{{max}}",get:function(e,t,n){var r=parseInt(t.data.max,10);return n(parseFloat(e)<=r),e}},chs:{message:"必须是中文字符",get:function(e,t,n){return n(/^[\u4e00-\u9fa5]+$/.test(e)),e}}})},function(e,t,n){var r=n(66),a=n(38);avalon.directive("if",{priority:6,parse:function(e,t,n){t.$prepend=(t.$prepend||"")+"var varIf = "+avalon.parseExpr(n)+"\nif(varIf){\n";var r=t.$append||"";t.$append='}else{\n\nvnodes.push({\nnodeType: 8,\ndirective:"if",\ntype: "#comment",\nnodeValue:"ms-if"\n})\n}'+r},diff:function(e,t,n){e.dom=t.dom,e.nodeType!==t.nodeType&&(e.steps=n,8===e.nodeType&&(e["ms-effect"]=t["ms-effect"]),a(e,this.update,n,"if"))},update:function(e,t,n){var a=e.nodeType,o=t.nodeType;if(a!==o){if(1===o){var i=t.dom;if(!i){i=avalon.vdomAdaptor(t,"toDOM"),t.dom=i;for(var s in t)if(0===s.indexOf("ms-on")){var l=t[s];"function"==typeof l&&(i._ms_context_=t.vmodel,avalon.bind(i,s.split("-")[2],l))}}return n.replaceChild(i,e),t.steps.count&&r([i],[t],n,t.steps),avalon.applyEffect(e,t,{hook:"onEnterDone"}),t.steps=!1}8===o&&avalon.applyEffect(e,t,{hook:"onLeaveDone",cb:function(){var r=e._ms_if_||(e._ms_if_=document.createComment(t.nodeValue));delete t["ms-effect"],n.replaceChild(r,e)}})}}})},function(e,t){function n(e,t,i,s){var l=e[0];if((l||i)&&s.count){i=i||l.parentNode;for(var c=0,u=t.length;u>c;c++){var p=t[c],f=l;if(!(avalon.msie<9&&!p.fixIESkip&&3===p.nodeType&&o.test(p.nodeValue))){if(f&&(l=f.nextSibling),"for"===p.directive&&p.forDiff){if(!f)return;if(1===f.nodeType){var d=document.createComment(p.nodeValue);i.insertBefore(d,f),p.endRepeat=document.createComment("ms-for-end:"),i.insertBefore(p.endRepeat,f.nextSibling),f=d}else p.endRepeat||(p.endRepeat=r(f));8!==f.nodeType&&(f=f.nextSibling),l=p.endRepeat.nextSibling}if(!1!==a(f,p,i,s,"change")){!p.skipContent&&p.children&&f&&1===f.nodeType&&n(avalon.slice(f.childNodes),p.children,f,s);var v=p.props&&p.props["ms-controller"];if(v&&f){var h=avalon.vmodels[v];h.$render&&(h.$render.dom=f)}if(a(f,p,i,s,"afterChange"),!s.count)break}else"number"==typeof p.repeatCount&&(c+=p.repeatCount+1),a(f,p,i,s,"afterChange")}}}}function r(e){for(var e,t=0,n=[];e&&(8===e.nodeType&&(0===e.nodeValue.indexOf("ms-for:")?++t:0===e.nodeValue.indexOf("ms-for-end:")&&--t),n.push(e),e=e.nextSibling,0!==t););return n.pop()}function a(e,t,n,r,a){var o=t[a];if(o){for(var i;i=o.shift();)if(r.count-=1,!1===i(e,t,n))return!1;delete t[a]}}var o=/^\s*$/;e.exports=n},function(e,t,n){function r(e){var t=typeof e;return e&&"object"===t?e.$hashcode:t+":"+e}function a(e,t){for(var n,r=t.signature,a=[],o=[],i={children:[]},s=0;n=e[s];s++)8===n.nodeType&&n.nodeValue===r?(i.children.push(n),i.key=n.key,o.push(n.key),i.index=a.length,a.push(i),i={children:[]}):i.children.push(n);t.components=a,t.compareText=o.length+"|"+o.join(";;")}function o(e,t,n){for(var r=[],a=[],o=[],i=e;i&&i!==t;i=i.nextSibling)a.push(i),8===i.nodeType&&i.nodeValue===n?(o.push(i),r.push(o),o=[]):o.push(i);return r.all=a,r}function i(e,t){for(var n,r=0,a=[];(n=e[t++])&&("#comment"===n.type&&(0===n.nodeValue.indexOf("ms-for:")?r++:0===n.nodeValue.indexOf("ms-for-end:")&&r--),a.push(n),0!==r););return a}function s(e){for(var t,n=0;t=e[n++];)t.dom&&(t.dom=null),t.children&&s(t.children)}function l(e,t){var n=t.match(w);if(n){var r=n[1];for(var a in e){var o=a.match(b);if(o&&o[1]===r)return c(e,a)}}}function c(e,t){var n=e[t],r=t;if(n){var a=e["***"+t];if(a){var o=a.pop();return delete e[o.id],0==a.length&&delete e["***"+t],o.c}for(var i=[{id:t,c:n}];;){if(t+="_",!e[t])break;i.push({id:t,c:e[t]})}var o=i.pop();return delete e[o.id],i.length&&(e["***"+r]=i),o.c}return n}function u(e,t){var n=t.key;if(e[n]){for(;;)if(n+="_",!e[n]){e[n]=t;break}}else e[n]=t}var p=n(66),f=/ms-for\:\s*/,d=/^\s*\(\s*/,v=/\s*\)\s*$/,h=/\s*,\s*/,m=/\s+as\s+([$\w]+)/,g=n(45).ident,y=n(38),_=/^(null|undefined|NaN|window|this|\$index|\$id)$/;avalon._each=function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++){var a=e[n],o=r(a);t(n,a,o)}else for(var n in e)e.hasOwnProperty(n)&&t(n,e[n],n)},avalon.directive("for",{priority:3,parse:function(e,t,n){var r,a=t.nodeValue;a=a.replace(m,function(e,t){return!g.test(t)||_.test(t)?avalon.error("alias "+t+" is invalid --- must be a valid JS identifier which is not a reserved name."):r=t,""});var o=a.replace(f,"").split(" in "),i="var loop = "+avalon.parseExpr(o[1])+" \n",s="var "+t.signature+" = vnodes[vnodes.length-1]\n",l=r?"var "+r+" = loop\n":"",c=o[0].replace(d,"").replace(v,"").split(h);1===c.length&&c.unshift("$key"),c.push("traceKey");var u=avalon.quote,p=[u(c[0])+":"+c[0],u(c[1])+":"+c[1]];r&&p.push(u(r)+":loop");var y="{"+p.join(",\n")+"}";t.$append=i+s+l+"avalon._each(loop,function("+c.join(", ")+"){\n__local__ = avalon.mix(__local__, "+y+")\n"},diff:function(e,t,n,r){var o=e[r],p=t[r]||{},f=e.slice(r,o.end);if(o.items=f.slice(1,-1),a(o.items,o),delete p.forDiff,o.compareText===p.compareText)return void avalon.shadowCopy(o,p);o.forDiff=!0;var d,v,h,m=!("items"in p);if(m){var g=i(t,r);p.items=g.slice(1,-1),p.components=[],p.repeatCount=p.items.length}var _=p.components.length;o.endRepeat=p.endRepeat;var w=Math.max(f.length-2,0)-p.repeatCount;if(w>0){for(var b=[r+1,0],d=0;w>d;d++)b.push(null);t.splice.apply(t,b)}else 0>w&&t.splice.apply(t,[r,Math.abs(w)]);if(o.action=m?"init":"update",m){var x=o.cache={};for(d=0;v=o.components[d];d++)u(x,v),v.action="enter";o.removedComponents={}}else{var x=p.cache;if(!x)return;var T=o.cache={};for(d=0;v=o.components[d];d++){var h=c(x,v.key);h?_--:_&&(h=l(x,v.key),h&&_--),v.action=h?"move":"enter",h&&(s(h.children),v.domIndex=h.index),u(T,v)}for(d in x){o.removedComponents=x;break}}return p.components.length=0,o.prevItems=p.items,o.steps=n,delete p.cache,delete p.items,y(o,this.update,n,"for"),r+f.length-1},update:function(e,t,n){var r=t.endRepeat,a=t.signature,i=o(e.nextSibling,r,a);0===i.length&&i.all.forEach(function(e){n.removeChild(e)});var s,l=avalon.avalonFragment;for(var c in t.removedComponents){var u=t.removedComponents[c],f=i[u.index];f&&(f.forEach(function(e,t){e.parentNode&&avalon.applyEffect(e,u.children[t],{hook:"onLeaveDone",cb:function(){console.log(e),e.parentNode.removeChild(e)},staggerKey:a+"leave"})}),u.children.length=0)}delete t.removedComponents;for(var d=e,v=[],c=0;c<t.components.length;c++){var h=t.components[c];if("enter"===h.action){s||(s=avalon.parseHTML(t.template));var m=s.cloneNode(!0);m.appendChild(document.createComment(t.signature));var g=avalon.slice(m.childNodes);n.insertBefore(m,d.nextSibling),x(g,h.children,{hook:"onEnterDone",staggerKey:a+"enter"})}else if("move"===h.action){for(var y,_=l.cloneNode(!1),g=i[h.domIndex]||[],w=0;y=g[w++];)_.appendChild(y);n.insertBefore(_,d.nextSibling),x(g,h.children,{hook:"onMoveDone",staggerKey:a+"move"})}if(v.push.apply(v,g),d=g[g.length-1],!d)break}var b=t.items,T=t.steps,E=T.count;t.repeatCount=b.length,avalon.diff(b,t.prevItems,T),T.count!==E&&p(v,b,n,T);var C=avalon.caches[t.cid];return C&&C.call(t.vmodel,{type:"rendered",target:e,endRepeat:r,signature:t.signature}),!1}});var w=/^(string|number|boolean)/,b=/^_*(string|number|boolean)/,x=function(e,t,n){t.forEach(function(r,a){avalon.applyEffect(e[a],t[a],n)})}},,,function(e,t,n){function r(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}function a(){if(!f.lock){var e=f[0];e&&(a.lock=!0,e())}}function o(e){var t=v.test(e)?1e3:1;return parseFloat(e)*t}function i(e,t,n){var r=e[t];r=Array.isArray(r)?r:"function"==typeof r?[r]:[],r.forEach(function(e){e&&e(n)})}function s(e){var t=e.toLowerCase();return function(n){var r,s=this.el,l=avalon(s),u=isFinite(n.stagger)?1e3*n.stagger:0;if(u&&n.staggerKey){var p=h.get(n.staggerKey)||h.put(n.staggerKey,{count:0,items:0});p.count++,p.items++}var d=p&&p.count||0,v=function(t){var o=t!==!1;s.animating=void 0,r=!0;var l=o?"Done":"Abort";i(n,"on"+e+l,s),avalon.unbind(s,c.transitionEndEvent),avalon.unbind(s,c.animationEndEvent),p&&0===--p.items&&(p.count=0),n.queue&&(f.lock=!1,f.shift(),a())};i(n,"onBefore"+e,s),n[t]?n[t](s,function(e){v(e!==!1)}):c.css&&(l.addClass(n[t+"Class"]),"leave"===t?l.removeClass(n.enterClass+" "+n.enterActiveClass):"enter"===t&&l.removeClass(n.leaveClass+" "+n.leaveActiveClass),l.bind(c.transitionEndEvent,v),l.bind(c.animationEndEvent,v),setTimeout(function(){r=NaN===avalon.root.offsetWidth,l.addClass(n[t+"ActiveClass"]);var e=window.getComputedStyle(s),a=e[c.transitionDuration],i=e[c.animationDuration],p=o(a)||o(i);0===!p?v(!1):u||setTimeout(function(){r||v(!1)},p+130)},17+u*d))}}function l(e){e.acton||(e.action=e.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}var c=n(71),u=n(28),p=n(38);avalon.directive("effect",{priority:5,diff:function(e,t,n,a){var o=e[a];if("string"==typeof o){var i=o;o=e[a]={is:i}}else Array.isArray(o)&&(o=e[a]=avalon.mix.apply({},o));if(o.action=o.action||"enter",Object(o)===o){var s=t[a];(Object(s)!==s||r(o,s))&&p(e,this.update,n,"effect","afterChange")}},update:function(e,t,n,r){if(!e.animating){e.animating=!0;var o=t["ms-effect"],i=o.is;if(r=r||{},!i)return avalon.warn("need is option");var s=avalon.effects;c.css&&!s[i]&&avalon.effect(i,{});var l=s[i];if(!l)return avalon.warn(i+" effect is undefined");var u=r.action||o.action,p=avalon.Effect;if("function"!=typeof p.prototype[u])return avalon.warn(u+" action is undefined");var d=new p(e),v=avalon.mix(r,l,o);v.queue?(f.push(function(){d[u](v)}),a()):setTimeout(function(){d[u](v)},4)}}});var f=[];avalon.effects={},avalon.effect=function(e,t){avalon.effects[e]=t||{},c.css&&(t.enterClass||(t.enterClass=e+"-enter"),t.enterActiveClass||(t.enterActiveClass=t.enterClass+"-active"),t.leaveClass||(t.leaveClass=e+"-leave"),t.leaveActiveClass||(t.leaveActiveClass=t.leaveClass+"-active")),t.action||(t.action="enter")};var d=function(e){this.el=e};avalon.Effect=d,d.prototype={enter:s("Enter"),leave:s("Leave"),move:s("Move")};var v=/\d+s$/,h=new u(128);avalon.applyEffect=function(e,t,n){var r=n.cb,a=n.hook,o=t["ms-effect"];if(o&&!avalon.document.hidden){var i=o[a];r&&(Array.isArray(i)?i.push(r):i?o[a]=[i,r]:o[a]=[r]),l(n),e.animate=!0,avalon.directives.effect.update(e,t,0,avalon.shadowCopy({},n))}else r&&r()}},function(e,t){var n,r,a,o=!1,i=!1,s=!1,l=avalon.cssName("transition-duration"),c=avalon.cssName("animation-duration"),u={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},p=avalon.window;for(var f in u){if(p[f]){a=u[f];break}try{document.createEvent(f);a=u[f];break}catch(d){}}"string"==typeof a&&(o=!0,s=!0,n=a),u={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};var v;for(f in u)if(p[f]){v=u[f];break}"string"==typeof v&&(i=!0,s=!0,r=v),e.exports={transition:o,animation:i,css:s,transitionEndEvent:n,animationEndEvent:r,transitionDuration:l,animationDuration:c}},function(e,t,n){function r(e,t){var n=Array.isArray(e)?a(e):e,r=[];if(t)for(var o in t)r.push("var "+o+" = __local__["+avalon.quote(o)+"]");var i="__local__ = __local__ || {};\nvar __present__, __top__,__synth__;\n"+r.join(";\n")+n,s=Function("__vmodel__","__local__",i);return s}avalon.lexer=n(73),avalon.diff=n(74),avalon.batch=n(75);var a=n(47);avalon.render=r,e.exports=avalon},function(e,t,n){function r(e){var t="??"+S++;return M[t]=e,t}function a(e){var t=M[e];return t}function o(e){return D.test(e)?e.replace(j,"").replace(k,r):e}function i(e,t,n){var i=[];if(n=n||1,"number"!=typeof t?t=0:t+=1,t>=n&&!O.rbind.test(e))return i;for(t||(e=e.replace(k,r));;){var u="",f=!1,v=e.match(_);if(v&&(u=v[0],f=new h(u.replace(A,a))),!f&&(v=e.match(w))){u=v[0],f=new m(v[1].replace(A,a));var b=f.nodeValue;if(T.test(b)){var E=i[i.length-1];E&&3===E.nodeType&&C.test(E.nodeValue)&&i.pop(),s(i)}}if(!f&&(v=e.match(g))){u=v[0];var S=v[1].toLowerCase();u=l(u,S),v=u.match(y);var D={};v[2]&&p(o(v[2]),D);var j=u.slice(v[0].length,-1*(S.length+3));f={nodeType:1,type:S,props:D,template:j.replace(A,a).trim(),children:[]},f=c(f,j,i,t,n)}if(f||(v=e.match(y),v&&(u=v[0],S=v[1].toLowerCase(),D={},v[2]&&p(o(v[2]),D),f={nodeType:1,type:S,props:D,template:"",children:[],isVoidTag:!0},f=c(f,"",i,t,n))),!f)break;i.push(f),e=e.slice(u.length),8===f.nodeType&&x.test(f.nodeValue)&&(f.signature=d("for"),e=e.replace($,""))}return t||(M={}),i}function s(e){for(var t,n=1,r=e.length,a=[];(t=e[--r])&&(8!==t.nodeType||(x.test(t.nodeValue)?n-=1:T.test(t.nodeValue)&&(n+=1),0!==n));)a.push(avalon.vdomAdaptor(t,"toHTML"));return t.template=a.reverse().join("")}function l(e,t){var n=[],r=[],a=L[t+"open"]||(L[t+"open"]=new RegExp("<"+t+N,P)),o=L[t+"close"]||(L[t+"close"]=new RegExp("</"+t+">",P));e.replace(a,function(e,t){return n.push(("0000000000"+t+"<").slice(-10)),e.replace(V,"1")}).replace(o,function(e,t){r.push(("0000000000"+t+">").slice(-10))});for(var i=n.concat(r).sort(),s=i.join("").replace(b,""),l=0,c=0,u=0,p=s.length;p>u;u++){var f=s.charAt(u);if("<"===f?l+=1:l-=1,0===l){c=u;break}}var d=parseFloat(i[c])+t.length+3;return e.slice(0,d)}function c(e,t,n,r,a){var o=e.type;if("ms-skip"in e.props)e.skipContent=!0;else{switch(o){case"style":case"script":case"noscript":case"template":case"textarea":e.skipContent=!0,"textarea"===o&&(e.props.type="textarea");break;case"input":e.props.type||(e.props.type="text");break;case"select":e.props.hasOwnProperty("multiple")&&(e.props.multiple="multiple",e.multiple=!0);break;case"xmp":e.children.push(new h(e.template));break;case"option":e.children.push(new h(f(e.template)))}if(!e.isVoidTag){var s=i(t,r,a);e.children=s,"table"===o&&u(e.children)}var l=e.props["ms-for"];if(l){var c=e.props["data-for-rendered"],p=c+":cb";return delete e.props["ms-for"],n.push({nodeType:8,type:"#comment",nodeValue:"ms-for:"+l,signature:d("for"),cid:p,template:avalon.vdomAdaptor(e,"toHTML")}),c&&!avalon.caches[p]&&(avalon.caches[p]=Function("return "+avalon.parseExpr(c,"on"))()),n.push(e),{nodeType:8,skipContent:!0,type:"#comment",nodeValue:"ms-for-end:"}}}return e}function u(e){for(var t,n=!1,r=0,a=0,o=e.length,i=0;o>i;i++){var s=e[i];t?"tr"!==s.type&&1===s.nodeType?t=!1:(t.children.push(s),r++,e[i]=0):"tr"===s.type&&(t={nodeType:1,type:"tbody",template:"",children:[],props:{}},t.children.push(s),n=!0,0===a&&(a=i),e[i]=t)}if(n)for(i=a;o>i&&(0!==e[i]||(e.splice(i,1),i--,r--,0!==r));i++);}function p(e,t){e.replace(R,"=").replace(H,function(e){var n=e.split("="),r=n[1]||"",o=n[0].toLowerCase();2===n.length&&0===r.indexOf("??")&&(r=r.replace(A,a).slice(1,-1).replace(I,"&").replace(F,'"')),t[o]=r})}function f(e){return String(e).replace(z,"").trim()}var d=avalon.makeHashCode,v=n(15),h=v.VText,m=v.VComment,g=/^<([^\s>\/=.$<]+)(?:\s+[^=\s]+(?:=[^>\s]+)?)*\s*>(?:[\s\S]*)<\/\1>/,y=/^<([^\s>\/=.$<]+)\s*([^>]*?)\/?>/,_=/^[^<]+/,w=/^<!--([\w\W]*?)-->/,b=/\d+/g,x=/^\s*ms-for\:/,T=/^\s*ms-for-end\:/,E=n(45),C=E.sp,A=/\?\?\d+/g,$=E.leftSp,k=E.string,O=avalon.config,M={},S=1,D=/=["']/,j=/\n\s*/g,N="(?:\\s+[^>=]*?(?:=[^>]+?)?)*>",L={},V=/./g,P=avalon.msie<9?"ig":"g",I=/&amp;/g,H=/\S+/g,F=/&quot;/g,R=/\s*=\s*/g,z=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi;e.exports=i},function(e,t,n){function r(e,t,n){if(e)for(var l=0;l<e.length;l++){var c=e[l],u=t[l]||i();switch(c.nodeType){case 3:c.skipContent||s.expr.diff(c,u,n);break;case 8:if("for"===c.directive){var p=s["for"].diff(e,t,n,l);"number"==typeof p&&(l=p)}else c.directive&&s[c.directive].diff(c,u,n);break;default:c.skipAttrs||a(c,u,n),c.skipContent||r(c.children,u.children||o,n)}}}function a(e,t,n){if(e.order){var r;try{e.order.replace(/([^;]+)/g,function(a){var o=a.match(l),c=o&&o[1];return r=c,s[c]&&s[c].diff(e,t||i(),n,a),a})}catch(a){avalon.log(r,a,a.message,"diffProps error")}}}var o=[],i=function(){return{children:[],props:{}}},s=avalon.directives,l=n(45).binding;avalon.diffProps=a,e.exports=r},function(e,t,n){function r(e){if(i)return avalon.Array.ensure(o,e);i=e;var t=avalon.scopes[e];if(!t||!document.nodeName)return i=null;var n=t.dom,s={count:0},l=t.render(t.synth||t.vmodel,t.local);avalon.diff(l,n.vtree||[],s),a([n],l,null,s),s.count=0,n.vtree=l,i=null;var c=o.indexOf(e);if(c>-1){var u=o.splice(c,1);return r(u[0])}var e=o.shift();e&&r(e)}var a=n(66),o=[],i=!1;avalon.suspendUpdate=0,e.exports=avalon.batch=r},,function(e,t){e.exports=avalon.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$model,$skipArray,$accessors,$hashcode,__proxy__,__data__,__const__")},,,function(e,t,n){function r(e,t){t.__vmodel__=e;var n=f.hideProperty;n(e,"$events",t),n(e,"$watch",function(){if(2===arguments.length)return m.apply(e,arguments);throw"$watch方法参数不对"}),n(e,"$fire",function(t,n,r){var a=e.$events[t];h(a,e,t,n,r)})}function a(e,t,n){return"$"===e.charAt(0)||n[e]||"function"==typeof t||t&&t.nodeName&&t.nodeType>0}function o(e,t,n,r){if(Array.isArray(e))return f.arrayFactory(e,t,n,r);if(Object(e)===e&&"function"!=typeof e){if(t&&t.$id){if(++avalon.suspendUpdate,t.$track!==Object.keys(e).sort().join(";;"))var a=f.slaveFactory(t,e,n,r);else a=t;for(var o in e)d[o]||(a[o]=e[o]);return--avalon.suspendUpdate,a}return a=f.masterFactory(e,n,r)}return e}function i(e,t,n){function r(){return a}var a=NaN;return r.heirloom=n,{get:r,set:function(o){if(a!==o){o&&"object"==typeof o&&(o=f.modelAdaptor(o,a,n,{pathname:t,id:e}));var i=a;a=o;var u=n.__vmodel__;if(this.$hashcode&&u&&!avalon.suspendUpdate){n!==u.$events&&(r.heirloom=u.$events),l(r.$decompose,t,o,i),-1===t.indexOf("*")&&h(r.heirloom[t],u,t,o,i),s(e,u,t,o,i),c(r.heirloom,u,t,o,i),avalon.rerenderStart=new Date;var p=u.$id.indexOf(".");p>0?avalon.batch(u.$id.slice(0,p),!0):avalon.batch(u.$id,!0)}}},enumerable:!0,configurable:!0}}function s(e,t,n,r,a){if(e.indexOf(".*.")>0){var o=e.match(g),i=avalon.vmodels[o[1]];if(i){var s=o[2];h(i.$events[s],t,n,r,a)}}}function l(e,t,n,r){if(e&&e[t]){var a=e[t];if(a.$hashcode){var o=t.replace(/^[^.]+\./,"");o!==t&&h(a.$events[o],a,o,n,r)}else delete e[t]}}function c(e,t,n,r,a){e.__fuzzy__&&e.__fuzzy__.replace(avalon.rword,function(o){var i=e[o],s=i.reg;return s&&s.test(n)&&h(i,t,n,r,a),o})}function u(e){var t=e.$id;if(!t&&avalon.config.debug&&avalon.warn("vm.$id must be specified"),avalon.vmodels[t])throw Error("error:["+t+"] had defined!");var n=f.masterFactory(e,{},{pathname:"",id:t,master:!0});return avalon.vmodels[t]=n}function p(e,t,n,r){if(t&&t.splice){var a=[0,t.length].concat(e);return++avalon.suspendUpdate,t.splice.apply(t,a),--avalon.suspendUpdate,t}for(var i in y)e[i]=y[i];e.notify=function(e,t,a,o){var i=n.__vmodel__;if(i){var s=null===e||void 0===e?r.pathname:r.pathname+"."+e;i.$fire(s,t,a),o||avalon.suspendUpdate||(avalon.rerenderStart=new Date,avalon.batch(i.$id,!0))}};var s=avalon.makeHashCode("$");r.array=!0,r.hashcode=s,r.id=r.id||s,f.initViewModel(e,n,{},{},r);for(var l=0,c=e.length;c>l;l++)e[l]=o(e[l],0,{},{id:e.$id+".*",master:!0});return e}var f={},d=n(77),v=n(81),h=v.$emit,m=v.$watch;f.modelAdaptor=o;var g=/([^.]+)\.(.+)/;f.arrayFactory=p;var y={set:function(e,t){if(e>>>0===e&&this[e]!==t){if(e>this.length)throw Error(e+"set方法的第一个参数不能大于原数组长度");this.splice(e,1,t)}},contains:function(e){return-1!==this.indexOf(e)},ensure:function(e){return this.contains(e)||this.push(e),this},pushArray:function(e){return this.push.apply(this,e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>>>0===e?this.splice(e,1):[]},clear:function(){return this.removeAll(),this}};avalon.define=u,e.exports={$$midway:f,$$skipArray:d,isSkip:a,__array__:y,initEvents:r,makeAccessor:i,modelAdaptor:o}},function(e,t){function n(e,t){var n,r=t.split(".")[0];try{e.hasOwnProperty(r)&&(n=e.$accessors?e.$accessors[r].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(e,r).get.heirloom.__vmodel__)}catch(a){}return n||e}function r(e){var t=e.split(".");return new RegExp("^"+t.map(function(e){return"*"===e?"(?:[^.]+)":e}).join("\\.")+"$","i")}function a(e,t,n){e&&(t.__fuzzy__?-1===t.__fuzzy__.indexOf(","+n)&&(t.__fuzzy__+=","+n):t.__fuzzy__=n)}function o(e,t){var n=e.indexOf(".*")>0||"*"===e,i=n?this:o.adjust(this,e),s=i.$events,l=s[e]||(s[e]=[]);return n&&(l.reg=l.reg||r(e)),a(n,s,e),i!==this&&(a(n,this.$events,e),this.$events[e]=l),avalon.Array.ensure(l,t),function(){avalon.Array.remove(l,t)}}function i(e,t,n,r,a,o){if(e&&e.length)try{for(o=o||e.length-1;o>=0;o--){var s=e[o];s.call(t,r,a,n)}}catch(l){o-1>0&&i(e,t,n,r,a,o-1),avalon.log(l,n)}}o.adjust=n,e.exports={$emit:i,$watch:o,adjustVm:n}},,,function(e,t,n){var r=n(3),a=n(4);r.shadowCopy(r,a),n(85),n(6),n(7),e.exports=r},function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.length,n=r.call(e);if(o.test(n))return!0;if("[object Object]"===n&&t===t>>>0)return!0}return!1}var r=avalon.inspect,a=/^\[object (?:Window|DOMWindow|global)\]$/,o=/(Array|List|Collection|Map|Arguments)\]$/;avalon.quote=JSON.stringify;var i={};"Boolean Number String Function Array Date RegExp Object Error".replace(avalon.rword,function(e){i["[object "+e+"]"]=e.toLowerCase()}),avalon.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?i[r.call(e)]||"object":typeof e},avalon.isFunction=function(e){return"function"==typeof e},avalon.isWindow=function(e){return a.test(r.call(e))},avalon.isPlainObject=function(e){return"[object Object]"===r.call(e)&&Object.getPrototypeOf(e)===Object.prototype},avalon.mix=avalon.fn.mix=function(){var e,t,n,r,a,o,i=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof i&&(c=i,i=arguments[1]||{},s++),"object"!=typeof i&&"function"!=typeof i&&(i={}),s===l&&(i=this,s--);l>s;s++)if(null!=(e=arguments[s]))for(t in e){n=i[t];try{r=e[t]}catch(u){continue}i!==r&&(c&&r&&(avalon.isPlainObject(r)||(a=Array.isArray(r)))?(a?(a=!1,o=n&&Array.isArray(n)?n:[]):o=n&&avalon.isPlainObject(n)?n:{},i[t]=avalon.mix(c,o,r)):void 0!==r&&(i[t]=r))}return i},avalon.each=function(e,t){if(e){var r=0;if(n(e))for(var a=e.length;a>r&&t(r,e[r])!==!1;r++);else for(r in e)if(e.hasOwnProperty(r)&&t(r,e[r])===!1)break}},e.exports={avalon:avalon,isArrayLike:n}},function(e,t,n){n(87),n(88),n(89),n(90),n(91),n(92),n(93),n(94),e.exports=avalon},function(e,t){function n(){return(new XMLSerializer).serializeToString(this)}function r(e,t){if(e&&e.childNodes)for(var n,o=e.childNodes,i=0;n=o[i++];)if(1===n.nodeType){var s=document.createElementNS(a,n.nodeName.toLowerCase());avalon.each(n.attributes,function(e,t){s.setAttribute(t.name,t.value)}),r(n,s),t.appendChild(s)}else t.appendChild(n.cloneNode(!0))}avalon.document.contains||(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),avalon.contains=function(e,t){try{for(;t=t.parentNode;)if(t===e)return!0;return!1}catch(n){return!1}};var a="http://www.w3.org/2000/svg",o=avalon.document.createElementNS(a,"svg");o.innerHTML='<circle fill="red" />',/^\[object SVG\w*Element\]$/.test(o.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{configurable:!0,get:n,set:function(e){var t=this.tagName.toLowerCase(),n=this.parent,a=avalon.parseHTML(e);if("svg"===t)n.insertBefore(a,this);else{var o=document.createDocumentFragment();r(a,o),n.insertBefore(o,this)}n.removeChild(this)}},innerHTML:{configurable:!0,get:function(){var e=this.outerHTML,t=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),n=new RegExp("</"+this.nodeName+">$","i");return e.replace(t,"").replace(n,"")},set:function(e){if(avalon.clearHTML){avalon.clearHTML(this);var t=avalon.parseHTML(e);r(t,this)}}}})},function(e,t){var n=/\S+/g;"add,remove".replace(avalon.rword,function(e){avalon.fn[e+"Class"]=function(t){var r=this[0]||{};return t&&"string"==typeof t&&1===r.nodeType&&t.replace(n,function(t){r.classList[e](t)}),this}}),avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&t.classList.contains(e)},toggleClass:function(e,t){var r="boolean"==typeof t,a=this;return String(e).replace(n,function(e){var n=r?t:!a.hasClass(e);a[n?"addClass":"removeClass"](e)}),this}})},function(e,t,n){function r(e,t){var n=t.changeAttr;if(n)for(var r in n){var i=n[r];if("src"===r&&window.chrome&&"EMBED"===e.tagName){e[r]=i;var s=e.parentNode,l=document.createComment("ms-src");s.replaceChild(l,e),s.replaceChild(e,l)}else if(0==r.indexOf("data-"))e.setAttribute(r,i);else{var c=a[r]||r;if("boolean"==typeof e[c]&&(e[c]=!!i),i===!1){e.removeAttribute(r);continue}var u=o.test(e)?!1:r in e.cloneNode(!1);u?e[c]=i+"":e.setAttribute(r,i)}}t.changeAttr=null}var a=n(23),o=/^\[object SVG\w*Element\]$/;avalon.parseJSON=JSON.parse,avalon.fn.attr=function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},e.exports=r},function(e,t){function n(e,t){if(e.offsetWidth<=0){var r=getComputedStyle(e,null);if(u.test(r.display)){var a={node:e};for(var o in c)a[o]=r[o],e.style[o]=c[o];t.push(a)}var i=e.parentNode;i&&1===i.nodeType&&n(i,t)}}function r(e){return e.window||e.defaultView||!1}var a=avalon.root,o=avalon.camelize,i=avalon.cssHooks,s=["","-webkit-","-o-","-moz-","-ms-"],l={"float":"cssFloat"};avalon.cssNumber=avalon.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(l[e])return l[e];t=t||a.style;for(var r=0,i=s.length;i>r;r++)if(n=o(s[r]+e),n in t)return l[e]=n;return null},avalon.fn.css=function(e,t){if(avalon.isPlainObject(e))for(var n in e)avalon.css(this,n,e[n]);else var r=avalon.css(this,e,t);return void 0!==r?r:this;
},avalon.fn.position=function(){var e,t,n=this[0],r={top:0,left:0};return n?("fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(r=e.offset()),r.top+=avalon.css(e[0],"borderTopWidth",!0),r.left+=avalon.css(e[0],"borderLeftWidth",!0),r.top-=e.scrollTop(),r.left-=e.scrollLeft()),{top:t.top-r.top-avalon.css(n,"marginTop",!0),left:t.left-r.left-avalon.css(n,"marginLeft",!0)}):r},avalon.fn.offsetParent=function(){for(var e=this[0].offsetParent;e&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||a)},i["@:set"]=function(e,t,n){e.style[t]=n},i["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,r=getComputedStyle(e);return r&&(n="filter"===t?r.getPropertyValue(t):r[t],""===n&&(n=e.style[t])),n},i["opacity:get"]=function(e){var t=i["@:get"](e,"opacity");return""===t?"1":t},"top,left".replace(avalon.rword,function(e){i[e+":get"]=function(t){var n=i["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}});var c={position:"absolute",visibility:"hidden",display:"block"},u=/^(none|table(?!-c[ea]).+)/;avalon.each({Width:"width",Height:"height"},function(e,t){var r="client"+e,a="scroll"+e,o="offset"+e;i[t+":get"]=function(t,n,r){var a=-4;"number"==typeof r&&(a=r),n="Width"===e?["Left","Right"]:["Top","Bottom"];var i=t[o];return 2===a?i+avalon.css(t,"margin"+n[0],!0)+avalon.css(t,"margin"+n[1],!0):(0>a&&(i=i-avalon.css(t,"border"+n[0]+"Width",!0)-avalon.css(t,"border"+n[1]+"Width",!0)),-4===a&&(i=i-avalon.css(t,"padding"+n[0],!0)-avalon.css(t,"padding"+n[1],!0)),i)},i[t+"&get"]=function(e){var r=[];n(e,r);for(var a,o=i[t+":get"](e),s=0;a=r[s++];){e=a.node;for(var l in a)"string"==typeof a[l]&&(e.style[l]=a[l])}return o},avalon.fn[t]=function(n){var s=this[0];if(0===arguments.length){if(s.setTimeout)return s["inner"+e];if(9===s.nodeType){var l=s.documentElement;return Math.max(s.body[a],l[a],s.body[o],l[o],l[r])}return i[t+"&get"](s)}return this.css(t,n)},avalon.fn["inner"+e]=function(){return i[t+":get"](this[0],void 0,-2)},avalon.fn["outer"+e]=function(e){return i[t+":get"](this[0],void 0,e===!0?2:0)}}),avalon.fn.offset=function(){var e=this[0];try{var t=e.getBoundingClientRect();if(t.width||t.height||e.getClientRects().length){var n=e.ownerDocument,r=n.documentElement,a=n.defaultView;return{top:t.top+a.pageYOffset-r.clientTop,left:t.left+a.pageXOffset-r.clientLeft}}}catch(o){return{left:0,top:0}}},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var a=this[0]||{},o=r(a),i="scrollTop"===e;return arguments.length?void(o?o.scrollTo(i?o[t]:n,i?n:o[t]):a[e]=n):o?o[t]:a[e]}})},function(e,t){function n(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}var r={"select:get":function a(e,t,n,o){var i,s=e.children;r["option:get"];n=t?n:e.selectedIndex,o=t?o:"select-one"===e.type||0>n,t=t||[];for(var l,c=0;l=s[c++];)if(!l.disabled)switch(l.nodeName.toLowerCase()){case"option":if(l.selected||l.index===n){if(i=l.value,o)return i;t.push(i)}break;case"optgroup":if(i=a(l,t,n,o),"string"==typeof i)return i}return o?null:t},"select:set":function(e,t,n){t=[].concat(t);for(var r,a=0;r=e.options[a++];)(r.selected=t.indexOf(r.value)>-1)&&(n=!0);n||(e.selectedIndex=-1)}};avalon.fn.val=function(e){var t=this[0];if(t&&1===t.nodeType){var a=0===arguments.length,o=a?":get":":set",i=r[n(t)+o];if(i)var s=i(t,e);else{if(a)return(t.value||"").replace(/\r/g,"");t.value=e}}return a?s:this}},function(e,t,n){var r=n(28),a=n(29),o=new function(){avalon.shadowCopy(this,{option:document.createElement("select"),thead:document.createElement("table"),td:document.createElement("tr"),area:document.createElement("map"),tr:document.createElement("tbody"),col:document.createElement("colgroup"),legend:document.createElement("fieldset"),_default:document.createElement("div"),g:document.createElementNS("http://www.w3.org/2000/svg","svg")}),this.optgroup=this.option,this.tbody=this.tfoot=this.colgroup=this.caption=this.thead,this.th=this.td},i={g:o.g};String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(avalon.rword,function(e){i[e]=o.g});var s,l=/<([\w:]+)/,c=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,u=/<|&#?\w+;/,p=new r(128),s=avalon.document.createElement("template");/HTMLTemplateElement/.test(s)||(s=null,avalon.shadowCopy(o,i)),avalon.parseHTML=function(e){var t,n=avalon.avalonFragment.cloneNode(!1);if("string"!=typeof e)return n;if(!u.test(e))return n.appendChild(document.createTextNode(e)),n;e=e.replace(c,"<$1></$2>").trim();var r=p.get(e);if(r)return r.cloneNode(!0);var t,f=(l.exec(e)||["",""])[1].toLowerCase(),d=i[f];if(d?d.innerHTML=e:s?(s.innerHTML=e,d=s.content):(d=o[f]||o._default,d.innerHTML=e),a(d),s)n=d;else for(;t=d.firstChild;)n.appendChild(t);return e.length<1024&&p.put(e,n.cloneNode(!0)),n},avalon.innerHTML=function(e,t){var n=this.parseHTML(t);this.clearHTML(e).appendChild(n)},avalon.clearHTML=function(e){for(e.textContent="";e.lastChild;)e.removeChild(e.lastChild);return e}},function(e,t,n){function r(e,t,n){var a=e.getAttribute("avalon-events");if(a&&(e.disabled!==!0||"click"!==t)){var o=[],i=h[t]||(h[t]=new RegExp(t+"\\:([^?s]+)","g"));a.replace(i,function(e,t){return o.push(t),e}),o.length&&n.push({elem:e,uuids:o})}e=e.parentNode;var s=avalon.gestureEvents||{};e&&e.getAttribute&&(p[t]||s[t])&&r(e,t,n)}function a(e){e=new i(e);var t=e.type,n=e.target,a=[];r(n,t,a);for(var o,s,l,c=0;(l=a[c++])&&!e.cancelBubble;)for(e.currentTarget=l.elem,o=0;(s=l.uuids[o++])&&!e.isImmediatePropagationStopped;){var u=avalon.eventListeners[s];if(u){var p=m.test(s)?l.elem._ms_context_:0;if(p&&p.$hashcode===!1)return avalon.unbind(n,t,u);if(g.test(t)){var f=+new Date;if(f-v>16){var d=u.call(p||n,e);v=f}}else d=u.call(p||n,e);d===!1&&(e.preventDefault(),e.stopPropagation())}}}function o(e){var t=c.getAttribute("delegate-events")||"";if(-1===t.indexOf(e)){var n=t.match(d)||[];n.push(e),c.setAttribute("delegate-events",n.join("??")),_(c,e,a,!!y[e])}}function i(e){if(e.originalEvent)return this;for(var t in e)b.test(t)||"function"==typeof e[t]||(this[t]=e[t]);this.timeStamp=new Date-0,this.originalEvent=e}var s=avalon.document,l=avalon.window,c=avalon.root,u=n(6).getShortID,p=n(33),f=avalon.eventHooks;avalon.bind=function(e,t,n){if(1===e.nodeType){var r=e.getAttribute("avalon-events")||"",i=u(n),s=f[t];s&&(t=s.type||t,s.fix&&(n=s.fix(e,n),n.uuid=i));var l=t+":"+i;avalon.eventListeners[n.uuid]=n,-1===r.indexOf(t+":")&&(p[t]||y[t]?o(t):_(e,t,a));var c=r.split("??");""===c[0]&&c.shift(),-1===c.indexOf(l)&&(c.push(l),e.setAttribute("avalon-events",c.join("??")))}else _(e,t,n);return n},avalon.unbind=function(e,t,n){if(1===e.nodeType){var r=e.getAttribute("avalon-events")||"";switch(arguments.length){case 1:w(e,t,a),e.removeAttribute("avalon-events");break;case 2:r=r.split("??").filter(function(e){return-1===e.indexOf(t+":")}).join("??"),e.setAttribute("avalon-events",r);break;default:var o=t+":"+n.uuid;r=r.split("??").filter(function(e){return e!==o}).join("??"),e.setAttribute("avalon-events",r),delete avalon.eventListeners[n.uuid]}}else w(e,t,n)};var d=/[^\s\?]+/g,v=Date.now(),h={},m=/^e\d+/,g=/move|scroll/,y={focus:!0,blur:!0},_=function(e,t,n,r){e.addEventListener(t,n,r)},w=function(e,t,n){e.removeEventListener(t,n)},b=/^(?:ms|webkit|moz)/;i.prototype={preventDefault:function(){var e=this.originalEvent;this.returnValue=!1,e&&(e.returnValue=!1,e.preventDefault())},stopPropagation:function(){var e=this.originalEvent;this.cancelBubble=!0,e&&(e.cancelBubble=!0,e.stopPropagation())},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=!0,e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},avalon.fireDom=function(e,t,n){var r=s.createEvent("Events");r.initEvent(t,!0,!0),avalon.shadowCopy(r,n),e.dispatchEvent(r)};var f=avalon.eventHooks;"onmouseenter"in c||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){f[e]={type:t,fn:function(t,n){return function(r){var a=r.relatedTarget;return a&&(a===t||16&t.compareDocumentPosition(a))?void 0:(delete r.type,r.type=e,n.call(this,r))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){l[e]&&!f.animationend&&(f.animationend={type:t})}),void 0===s.onmousewheel&&(f.mousewheel={type:"wheel",fn:function(e,t){return function(e){e.wheelDeltaY=e.wheelDelta=e.deltaY>0?-120:120,e.wheelDeltaX=0,Object.defineProperty(e,"type",{value:"mousewheel"}),t.call(this,e)}}}),avalon.fn.bind=function(e,t,n){return this[0]?avalon.bind(this[0],e,t,n):void 0},avalon.fn.unbind=function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this},avalon.$$unbind=function(e){var t=e.querySelectorAll("[avalon-events]");avalon.each(t,function(e,t){avalon.unbind(t)})}},function(e,t,n){var r,a=n(35),o=avalon.document,i=avalon.window,s=[],l=function(e){for(r=!0;e=s.shift();)e(avalon)};"complete"===o.readyState?setTimeout(l):o.addEventListener("DOMContentLoaded",l),avalon.bind(i,"load",l),avalon.ready=function(e){r?e(avalon):s.push(e)},avalon.ready(function(){a(o.body)})},function(e,t,n){n(37),n(39),n(96),n(41),n(42),n(97),n(44),n(46),n(53),n(54),n(98),n(63),n(64),n(65),n(67),n(101),n(70)},function(e,t,n){var r=n(89),a=n(38);avalon.directive("attr",{diff:function(e,t,n,o){var i=e[o],s=t[o];if(Object(i)===i){if(Array.isArray(i)&&(i=e[o]=avalon.mix.apply({},i)),"object"!=typeof s)e.changeAttr=i;else{var l={},c=!1;for(var u in i)i[u]!==s[u]&&(c=!0,l[u]=i[u]);c&&(e.changeAttr=l,n.count+=1)}e.changeAttr&&a(e,r,n,"attr")}else e[o]=s},update:r})},function(e,t,n){var r=n(38);avalon.directive("expr",{parse:function(){},diff:function(e,t,n){e.nodeValue!==t.nodeValue&&r(e,this.update,n,"expr")},update:function(e,t,n){if(3!==e.nodeType){var r=document.createTextNode(t.nodeValue);n.replaceChild(r,e)}else e.nodeValue=t.nodeValue}})},function(e,t,n){function r(e){for(var t,n=0;t=this.parser[n++];){var r=avalon.parsers[t];r&&(e=r.call(this,e))}return e}var a=n(38),o=n(49),i=n(52),s=/\|\s*change\b/,l=/^(?:checkbox|radio)$/,c=/\|\s*debounce(?:\(([^)]+)\))?/,u=n(56),p=n(99),f=n(60),d=n(58),v=n(100),h=n(62);avalon.directive("duplex",{priority:2e3,parse:function(e,t,n){var r,a=n.expr,u=t.props.type,p=n.param,f=!1;p=p?"["+p.split("-").map(function(e){return"checked"===e&&(f=!0),avalon.quote(e)})+"]":"[]",l.test(u)&&f&&(p="[]",r="radio"),/input|textarea|select/.test(t.type)?r||(r="select"===t.type?"select":"checkbox"===u?"checkbox":"radio"===u?"radio":"input"):"contenteditable"in t.props&&(r="contenteditable");var d=!1,v=0;if(("input"===r||"contenteditable"===r)&&(s.test(a)&&(d=!0),!d)){var h=a.match(c);h&&(v=parseInt(h[1],10)||300)}e.vmodel="__vmodel__",e.modelValue="("+avalon.parseExpr(n,"duplex")+")(__vmodel__)",e.duplexSetter=o.get("duplex:set:"+a);var m=o.get("duplex:format:"+a),g=e.props["data-duplex-changed"];e.callback=g?avalon.parseExpr(g,"on"):"avalon.noop",e.duplexFormat=m||"function(vm, a){return a}",e.duplexData=i({type:r,isChecked:f,isChanged:d,parser:p,callback:g?avalon.parseExpr(n,"on"):"avalon.noop",debounceTime:v,vmodel:"__vmodel__"})},diff:function(e,t,n){var r=e.modelValue,o=t.modelValue,i=e.duplexFormat(e.vmodel,r);String(i)!==String(e.duplexFormat(e.vmodel,o))&&(e.viewValue=i,"select"!==e.type||e.children.length||(avalon.Array.merge(e.children,avalon.lexer(e.template,0,2)),u(e,i)),a(e,this.update,n,"duplex","afterChange"))},update:function(e,t){if(e&&1===e.nodeType){e.getAttribute("duplex-inited")||(e.__ms_duplex__=t.duplexData,e.setAttribute("duplex-inited","true"),p(e,t));var n=e.__ms_duplex__;if(n.format=t.duplexFormat,n.set=t.duplexSetter,n.parse=r,n.element=e,n.callback=t.callback,h(e,t),!avalon.msie&&f===!1&&!e.valueHijack){e.valueHijack=d;var a=setInterval(function(){avalon.contains(avalon.root,e)?e.valueHijack():clearInterval(a)},30)}if(n.viewValue!==t.viewValue){if(n.modelValue=t.modelValue,!Array.isArray(t.modelValue)){var o=n.parse(t.viewValue);o!==n.modelValue&&n.set(n.vmodel,o)}if(n.viewValue=t.viewValue,n.element=e,v[n.type].call(n),e.caret){var i=n.caretPos;i&&n.setCaret(e,i.start,i.end),n.caretPos=null}}}}})},function(e,t,n){function r(e,t){var n={},r=t.duplexData;switch(r.update=u,r.type){case"radio":"radio"===t.props.type?n.click=u:n.change=u;break;case"checkbox":case"select":n.change=u;break;case"contenteditable":r.isChanged?n.blur=u:(f.webkitURL?n.webkitEditableContentChanged=u:f.MutationEvent&&(n.DOMCharacterDataModified=u),n.input=u);break;case"input":r.isChanged?n.change=u:(n.input=u,avalon.msie||(n.compositionstart=i,n.compositionend=s))}/password|text/.test(t.props.type)&&(n.focus=a,n.blur=o,r.getCaret=l,r.setCaret=c);for(var p in n)avalon.bind(e,p,n[p])}function a(){this.caret=!0}function o(){this.caret=!1}function i(){this.composing=!0}function s(e){this.composing=!1}function l(e){var t=NaN,n=NaN;return e.setSelectionRange&&(t=e.selectionStart,n=e.selectionEnd),{start:t,end:n}}function c(e,t,n){e.value&&!e.readOnly&&(e.selectionStart=t,e.selectionEnd=n)}var u=n(58),p=n(6).getShortID,f=(avalon.msie,avalon.window);avalon.document;p(a),p(o),p(i),p(s),p(u),e.exports=r},function(e,t){var n={input:function(){this.element.value=this.viewValue},radio:function(){var e;e=this.isChecked?!!this.viewValue:this.viewValue+""===this.element.value;var t=this.element;t.checked=e},checkbox:function(){for(var e=!1,t=this.element,n=t.value,r=0;r<this.modelValue.length;r++){var a=this.modelValue[r];a+""===n&&(e=!0)}t.checked=e},select:function(){var e=Array.isArray(this.viewValue)?this.viewValue.map(String):this.viewValue+"";avalon(this.element).val(e)},contenteditable:function(){this.element.innerHTML=this.viewValue,this.update.call(this.element)}};e.exports=n},function(e,t,n){var r=n(102),a=n(66),o=n(38),i=avalon.directive("widget",{priority:4,parse:function(e,t,n){var r=t.props.wid||avalon.makeHashCode("w");e.wid=avalon.quote(r),e.directive="widget",e.template=t.template,e.children="[]",e[n.name]=avalon.parseExpr(n);var a=t.$append||"";t.$append=["var il1492 = vnodes.length - 1","var el1492 = vnodes[il1492]","if(el1492.nodeType === 1){","el1492.local = __local__","el1492.vmodel = __vmodel__","avalon.component(el1492, vnodes, il1492,"+e.wid+")","}"].join("\n ")+a},define:function(){return avalon.mediatorFactory.apply(this,arguments)},diff:function(e,t,n){function r(t,n){e.vmodel.$fire("onReady",{type:"ready",target:t,wid:a,vmodel:n.vmodel})}var a=e.wid,i=avalon.scopes[a];if(8===e.nodeType)n.count+=1,e.change=[this.replaceByComment];else if(i&&1===i.renderCount)i.vmodel.$fire("onInit",{type:"init",vmodel:i.vmodel,wid:a,componentName:i.componentName}),i.renderCount=2,t.children=[],e.steps=n,o(e,this.replaceByComponent,n,"widget"),o(e,r,n,"widget","afterChange");else{i.renderCount++,i.pre&&t.wid===i.pre.wid&&avalon.mix(t,i.pre);var s=!e.diff||e.diff(e,t,n);e.skipContent=!s,t.wid&&e.wid!==t.wid&&!t.props.cached&&(delete avalon.scopes[t.wid],delete avalon.vmodels[t.wid]);var l=e.vmodel.$events.onViewChange;l&&l.length&&(n.count+=1,e.afterChange=[function(n,r){var o=t.outerHTML,i=e.outerHTML||(e.outerHTML=avalon.vdomAdaptor(e,"toHTML"));o!==i&&e.vmodel.$fire("onViewChange",{type:"viewchange",target:n,wid:a,vmodel:r.vmodel})}])}},addDisposeMonitor:function(e){r.byRewritePrototype(e)},replaceByComment:function(e,t,n){var r=document.createComment(t.nodeValue);e?n.replaceChild(r,e):n.appendChild(r)},replaceByComponent:function(e,t,n){var r=avalon.vdomAdaptor(t,"toDOM");t.ouerHTML=avalon.vdomAdaptor(t,"toHTML"),e?n.replaceChild(r,e):n.appendChild(r),a([r],[t],n,t.steps);var o=t.vmodel,s=avalon.scopes[o.$id];return s.dom=r,o.$element=r,r.vtree=[t],i.addDisposeMonitor(r),!1}})},function(e,t){function n(){function e(e,t){var n=r[e];r[e]=function(e,r){return t.call(this,n,e,r)}}function t(e){var t=avalon.slice(this.getElementsByTagName("*"));l.call(this,e),i(t)}if(!n.execute){n.execute=!0;var r=Node.prototype;e("removeChild",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&o(t),t}),e("replaceChild",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&o(t),t});var a=Element.prototype,s=Object.getOwnPropertyDescriptor(a,"innerHTML"),l=s.set;s.set=t,Object.defineProperty(a,"innerHTML",s),e("appendChild",function(e,t){return e.call(this,t),1===t.nodeType&&11===this.nodeType&&o(t),t}),e("insertBefore",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&11===this.nodeType&&o(t),t})}}function r(e){for(;e;){if(9===e.nodeType)return!0;e=e.parentNode}return!1}function a(e){if(1===e.nodeType&&e.getAttribute("wid")&&!r(e)){var t=e.getAttribute("wid"),n=avalon.scopes[t];if(!n)return;var a=n.vmodel;return n.vmodel.$fire("onDispose",{type:"dispose",target:e,vmodel:a}),n&&!e.getAttribute("cached")&&(a.$element=null,a.$hashcode=!1,delete n.vmodel,delete n.dom,delete avalon.scopes[t]),!1}}function o(e){setTimeout(function(){a(e)},4)}function i(e){for(var t,n=0;t=e[n++];)a(t)}e.exports={byRewritePrototype:n}},function(e,t,n){function r(e,t){if(!e)return!0;var n=avalon.mix(t||{},e);for(var r in n)if("is"!==r&&"$id"!==r)return!1;return!0}function a(e,t,n,r,a){if(!s(e))return n[r]=g;var o=t.$id,i=avalon.scopes[o];if(i&&i.dom)i.pre=i.dom.vtree[0],i.dom.vtree=[e];else{var i={componentName:a,vmodel:t,render:t.$render,local:e.local,renderCount:1};avalon.scopes[o]=i}n[r]=e}function o(e){return y.test(e)}function i(e,t,n){for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];h[r]?r in e?e[r].push(a):e[r]=[t[r]]:isFinite(n)&&(e[r]=a)}}function s(e){var t=!0;try{l(e)}catch(n){t=!1}return t}function l(e){e.children.forEach(function(e){if(8===e.nodeType){if(e===g)throw"unresolved"}else e.children&&l(e)})}function c(e,t,n){var r={};n?r[n]=t.children:t.children.forEach(function(e){if(1===e.nodeType){var t=e.props.slot||"default";r[t]?r[t].push(e):r[t]=[e]}}),u(e,r)}function u(e,t){for(var n,r=0;n=e[r++];)if(1===n.nodeType)if("slot"===n.type){var a=n.props.name||"default";if(t[a]){var o=t[a];e.splice.apply(e,[r-1,1].concat(o)),1===o.length&&3===o[0].nodeType&&p(e)}}else u(n.children,t);return e}function p(e){for(var t,n=0;t=e[n];n++)if(t.skipContent===!1&&3===t.nodeType){var r=e[n-1],a=e[n+1];r&&3===r.nodeType&&!/\S/.test(r.nodeValue)&&(avalon.Array.remove(e,r),--n),a&&3===a.nodeType&&!/\S/.test(a.nodeValue)&&avalon.Array.remove(e,a)}}var f=n(16),d=(n(47),n(77),{wbr:1,xmp:1,template:1}),v="onInit,onReady,onViewChange,onDispose",h=avalon.oneObject(v),m=v.split(",").concat("is","diff","define"),g={nodeType:8,type:"#comment",directive:"widget",nodeValue:"unresolved component placeholder"};avalon.component=function(e,t){if(arguments.length<4)avalon.components[e]||(avalon.components[e]=t);else{var n=arguments[0],s=arguments[1],l=arguments[2],p=arguments[3],v=n.vmodel,y={};if(r(n["ms-widget"],y))w=!0;else{var _=[].concat(n["ms-widget"]||[]);_.forEach(function(e,t){i(y,e,t)});var w=r(y)}var b=n.type.indexOf("-")>0?n.type:y.is;if(!avalon.components[b])return s[l]=g;var x=b.replace(/-/g,"_");v.hasOwnProperty(x)&&"object"==typeof v[x]&&(y={},_=[v[x]],i(y,v[x],0),m=[x].concat(m));var T=avalon.scopes[y.$id]||avalon.scopes[p];if(T&&T.dom){var E=T.render(T.vmodel,T.local);if(E[0])return a(E[0],T.vmodel,s,l)}var C=n.type;d[C]||o(C)||avalon.warn(C+"不合适做组件的标签"),"xmp"!==C&&"template"!==C&&0!==n.children.length||(n.children=avalon.lexer(n.template)),t=avalon.components[b];var A=y.diff,$=y.define;$=$||avalon.directives.widget.define;var k=y.$id||p,O=avalon.mix(!0,{},t.defaults);i(y,O,!1),defineArgs=[v,O].concat(_);var M=$.apply(function(e,t){m.forEach(function(n){delete e[n],delete t[n]})},defineArgs);M.$id=k;var S=t.template.trim();"function"==typeof t.getTemplate&&(S=t.getTemplate(M,S));var D=avalon.lexer(S);D.length>1&&avalon.error("组件必须用一个元素包起来");var j=D[0];if(avalon.vmodels[k]=M,avalon.mix(j.props,n.props),j.props.wid=k,t.soleSlot){var N={},L=t.soleSlot;N[L]=/\S/.test(n.template)?n.children:new f("{{@"+L+"}}"),u(D,N)}else n.isVoidTag||c(D,n,t.soleSlot);for(var V in h)y[V]&&y[V].forEach(function(e){M.$watch(V,e)});D[0].directive="widget";var P=avalon.render(D,n.local);M.$render=P;try{var E=P(M,n.local)}catch(V){E=[g]}var I=E[0];I.diff=A,a(I,M,s,l,b)}};var y=/^[a-z]([a-z\d]+\-)+[a-z\d]+$/},function(e,t,n){function r(){}function a(e,t,n){var a={};e.$skipArray&&(a=avalon.oneObject(e.$skipArray),delete e.$skipArray);var o={};n=n||{},t=t||{};var i={},s=m("$"),l=n.pathname||"";n.id=n.id||s,n.hashcode=s;var u,h,g;for(u in e)if(!p[u]){var y=o[u]=e[u];c(u,y,a)||(h=n.id+"."+u,g=l?l+"."+u:u,i[u]=f(h,g,t))}i.$model=v;var _=new r;Object.defineProperties(_,i);for(u in o)_[u]=o[u],u in a?delete o[u]:o[u]=!0;return d(_,t,o,i,n),_}function o(e,t,n,r){var a={},o={},i=r.pathname;n=n||{};var s,l,u;for(s in t)if(!p[s]&&(a[s]=t[s],!c(s,t[s],g))){var h=Object.getOwnPropertyDescriptor(e,s);h&&h.get?o[s]=h:(l=r.id+"."+s,u=i?i+"."+s:s,o[s]=f(l,u,n))}for(s in e)delete e[s];r.hashcode=e.$hashcode||m("$"),o.$model=v;var y=e;Object.defineProperties(y,o);for(s in a)o[s]||(y[s]=a[s]),a[s]=!0;return d(y,n,a,o,r),y}function i(e,t){for(var n,a,o={},i={},s={},l={},u={},v=avalon.slice(arguments),h=0;h<v.length;h++){var g=v[h];for(var y in g){o[y]=g[y],"$skipArray"===y&&Array.isArray(g.$skipArray)&&g.$skipArray.forEach(function(e){u[e]=1});var _=Object.getOwnPropertyDescriptor(g,y);_.set?-1===v.indexOf(g[y])?i[y]=_:(n=o[y],a=y,delete o[y]):"function"!=typeof o[y]&&(s[y]=1)}}"function"==typeof this&&this(o,s);for(y in s)p[y]||i[y]||c(y,o[y],u)||(i[y]=f(e.$id+"."+y,y,l),i[y].set(o[y]));var w=new r;Object.defineProperties(w,i);for(y in o){if(i[y]||(w[y]=o[y]),a&&i[y]&&n.hasOwnProperty(y)){var b=i[y];b.get.$decompose||(b.get.$decompose={}),b.get.$decompose[a+"."+y]=w}o[y]=!0}return d(w,l,o,i,{id:e.$id,hashcode:m("$"),master:!0}),w}function s(e,t){e.length!==t&&e.notify("length",e.length,t,!0)}var l=n(105),c=l.isSkip,u=l.$$midway,p=l.$$skipArray;delete p.$accessors,delete p.__data__,delete p.__proxy__,delete p.__const__;var f=l.makeAccessor,d=l.initViewModel,v=l.modelAccessor,h=l.modelAdaptor,m=avalon.makeHashCode;u.masterFactory=a;var g={};u.slaveFactory=o,u.mediatorFactory=avalon.mediatorFactory=i;var y=l.__array__,_=Array.prototype,w=_.splice;y.removeAll=function(e){var t=this.length;if(Array.isArray(e))for(var n=this.length-1;n>=0;n--)-1!==e.indexOf(this[n])&&w.call(this,n,1);else if("function"==typeof e)for(n=this.length-1;n>=0;n--){var r=this[n];e(r,n)&&w.call(this,n,1)}else w.call(this,0,this.length);s(this,t),this.notify()};var b=["push","pop","shift","unshift","splice"];b.forEach(function(e){var t=_[e];y[e]=function(n,r){var a=[],o=this.length;if("splice"===e&&Object(this[0])===this[0])for(var i=this.slice(n,r),l=_.slice.call(arguments,2),a=[n,r],c=0,u=l.length;u>c;c++){var p=i[c];a[c+2]=h(l[c],p,p&&p.$events||{},{id:this.$id+".*",master:!0})}else for(var f=0,d=arguments.length;d>f;f++)a[f]=h(arguments[f],0,{},{id:this.$id+".*",master:!0});var v=t.apply(this,a);return s(this,o),this.notify(),v}}),"sort,reverse".replace(avalon.rword,function(e){y[e]=function(){return _[e].apply(this,arguments),this.notify(),this}}),e.exports=avalon},function(e,t,n){function r(e){var t=avalon.type(e);if("array"===t){for(var n=[],a=0;a<e.length;a++)n[a]=r(e[a]);return n}if("object"===t){var o={};for(a in e)if(e.hasOwnProperty(a)){var i=e[a];o[a]=i&&i.nodeType?i:r(i)}return o}return e}function a(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!1,configurable:!0})}function o(e,t,n,r,o){function i(e){return n[e]===!0}o.array?Object.defineProperty(e,"$model",l):a(e,"hasOwnProperty",i),a(e,"$id",o.id),a(e,"$hashcode",o.hashcode),a(e,"$track",Object.keys(n).sort().join(";;")),o.master===!0&&(a(e,"$element",null),a(e,"$render",0),s(e,t))}var i=n(80),s=i.initEvents,l={get:function(){return r(this)},set:avalon.noop,enumerable:!1,configurable:!0};i.$$midway.hideProperty=a,i.$$midway.initViewModel=o;var c={toJson:r,initViewModel:o,modelAccessor:l};for(var u in i)c[u]=i[u];e.exports=c}])}),function(e,t,n,r){"use strict";function a(e,t,n){return setTimeout(c(e,n),t)}function o(e,t,n){return Array.isArray(e)?(i(e,n[t],n),!0):!1}function i(e,t,n){var a;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==r)for(a=0;a<e.length;)t.call(n,e[a],a,e),a++;else for(a in e)e.hasOwnProperty(a)&&t.call(n,e[a],a,e)}function s(t,n,r){var a="DEPRECATED METHOD: "+n+"\n"+r+" AT \n";return function(){var n=new Error("get-stack-trace"),r=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=e.console&&(e.console.warn||e.console.log);return o&&o.call(e.console,a,r),t.apply(this,arguments)}}function l(e,t,n){var r,a=t.prototype;r=e.prototype=Object.create(a),r.constructor=e,r._super=a,n&&pe(r,n)}function c(e,t){return function(){return e.apply(t,arguments)}}function u(e,t){return typeof e==ve?e.apply(t?t[0]||r:r,t):e}function p(e,t){return e===r?t:e}function f(e,t,n){i(m(t),function(t){e.addEventListener(t,n,!1)})}function d(e,t,n){i(m(t),function(t){e.removeEventListener(t,n,!1)})}function v(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function h(e,t){return e.indexOf(t)>-1}function m(e){return e.trim().split(/\s+/g)}function g(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function y(e){return Array.prototype.slice.call(e,0)}function _(e,t,n){for(var r=[],a=[],o=0;o<e.length;){var i=t?e[o][t]:e[o];g(a,i)<0&&r.push(e[o]),a[o]=i,o++}return n&&(r=t?r.sort(function(e,n){return e[t]>n[t]}):r.sort()),r}function w(e,t){for(var n,a,o=t[0].toUpperCase()+t.slice(1),i=0;i<fe.length;){if(n=fe[i],a=n?n+o:t,a in e)return a;i++}return r}function b(){return we++}function x(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}function T(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){u(e.options.enable,[e])&&n.handler(t)},this.init()}function E(e){var t,n=e.options.inputClass;return new(t=n?n:Te?I:Ee?R:xe?q:P)(e,C)}function C(e,t,n){var r=n.pointers.length,a=n.changedPointers.length,o=t&Me&&r-a===0,i=t&(De|je)&&r-a===0;n.isFirst=!!o,n.isFinal=!!i,o&&(e.session={}),n.eventType=t,A(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function A(e,t){var n=e.session,r=t.pointers,a=r.length;n.firstInput||(n.firstInput=O(t)),a>1&&!n.firstMultiple?n.firstMultiple=O(t):1===a&&(n.firstMultiple=!1);var o=n.firstInput,i=n.firstMultiple,s=i?i.center:o.center,l=t.center=M(r);t.timeStamp=ge(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=N(s,l),t.distance=j(s,l),$(n,t),t.offsetDirection=D(t.deltaX,t.deltaY);var c=S(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=me(c.x)>me(c.y)?c.x:c.y,t.scale=i?V(i.pointers,r):1,t.rotation=i?L(i.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,k(n,t);var u=e.element;v(t.srcEvent.target,u)&&(u=t.srcEvent.target),t.target=u}function $(e,t){var n=t.center,r=e.offsetDelta||{},a=e.prevDelta||{},o=e.prevInput||{};t.eventType!==Me&&o.eventType!==De||(a=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=a.x+(n.x-r.x),t.deltaY=a.y+(n.y-r.y)}function k(e,t){var n,a,o,i,s=e.lastInterval||t,l=t.timeStamp-s.timeStamp;if(t.eventType!=je&&(l>Oe||s.velocity===r)){var c=t.deltaX-s.deltaX,u=t.deltaY-s.deltaY,p=S(l,c,u);a=p.x,o=p.y,n=me(p.x)>me(p.y)?p.x:p.y,i=D(c,u),e.lastInterval=t}else n=s.velocity,a=s.velocityX,o=s.velocityY,i=s.direction;t.velocity=n,t.velocityX=a,t.velocityY=o,t.direction=i}function O(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:he(e.pointers[n].clientX),clientY:he(e.pointers[n].clientY)},n++;return{timeStamp:ge(),pointers:t,center:M(t),deltaX:e.deltaX,deltaY:e.deltaY}}function M(e){var t=e.length;if(1===t)return{x:he(e[0].clientX),y:he(e[0].clientY)};for(var n=0,r=0,a=0;t>a;)n+=e[a].clientX,r+=e[a].clientY,a++;return{x:he(n/t),y:he(r/t)}}function S(e,t,n){return{x:t/e||0,y:n/e||0}}function D(e,t){return e===t?Ne:me(e)>=me(t)?0>e?Le:Ve:0>t?Pe:Ie}function j(e,t,n){n||(n=ze);var r=t[n[0]]-e[n[0]],a=t[n[1]]-e[n[1]];return Math.sqrt(r*r+a*a)}function N(e,t,n){n||(n=ze);var r=t[n[0]]-e[n[0]],a=t[n[1]]-e[n[1]];return 180*Math.atan2(a,r)/Math.PI}function L(e,t){return N(t[1],t[0],qe)+N(e[1],e[0],qe)}function V(e,t){return j(t[0],t[1],qe)/j(e[0],e[1],qe)}function P(){this.evEl=Ye,this.evWin=We,this.pressed=!1,T.apply(this,arguments)}function I(){this.evEl=Ke,this.evWin=Ze,T.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function H(){this.evTarget=Je,this.evWin=Qe,this.started=!1,T.apply(this,arguments)}function F(e,t){var n=y(e.touches),r=y(e.changedTouches);return t&(De|je)&&(n=_(n.concat(r),"identifier",!0)),[n,r]}function R(){this.evTarget=tt,this.targetIds={},T.apply(this,arguments)}function z(e,t){var n=y(e.touches),r=this.targetIds;if(t&(Me|Se)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var a,o,i=y(e.changedTouches),s=[],l=this.target;if(o=n.filter(function(e){return v(e.target,l)}),t===Me)for(a=0;a<o.length;)r[o[a].identifier]=!0,a++;for(a=0;a<i.length;)r[i[a].identifier]&&s.push(i[a]),t&(De|je)&&delete r[i[a].identifier],a++;return s.length?[_(o.concat(s),"identifier",!0),s]:void 0}function q(){T.apply(this,arguments);var e=c(this.handler,this);this.touch=new R(this.manager,e),this.mouse=new P(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function B(e,t){e&Me?(this.primaryTouch=t.changedPointers[0].identifier,Y.call(this,t)):e&(De|je)&&Y.call(this,t)}function Y(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches,a=function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)};setTimeout(a,nt)}}function W(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var a=this.lastTouches[r],o=Math.abs(t-a.x),i=Math.abs(n-a.y);if(rt>=o&&rt>=i)return!0}return!1}function U(e,t){this.manager=e,this.set(t)}function X(e){if(h(e,ct))return ct;var t=h(e,ut),n=h(e,pt);return t&&n?ct:t||n?t?ut:pt:h(e,lt)?lt:st}function K(){if(!ot)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){t[r]=n?e.CSS.supports("touch-action",r):!0}),t}function Z(e){this.options=pe({},this.defaults,e||{}),this.id=b(),this.manager=null,this.options.enable=p(this.options.enable,!0),this.state=dt,this.simultaneous={},this.requireFail=[]}function G(e){return e&yt?"cancel":e&mt?"end":e&ht?"move":e&vt?"start":""}function J(e){return e==Ie?"down":e==Pe?"up":e==Le?"left":e==Ve?"right":""}function Q(e,t){var n=t.manager;return n?n.get(e):e}function ee(){Z.apply(this,arguments)}function te(){ee.apply(this,arguments),this.pX=null,this.pY=null}function ne(){ee.apply(this,arguments)}function re(){Z.apply(this,arguments),this._timer=null,this._input=null}function ae(){ee.apply(this,arguments)}function oe(){ee.apply(this,arguments)}function ie(){Z.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function se(e,t){return t=t||{},t.recognizers=p(t.recognizers,se.defaults.preset),new le(e,t)}function le(e,t){this.options=pe({},se.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=E(this),this.touchAction=new U(this,this.options.touchAction),ce(this,!0),i(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function ce(e,t){var n=e.element;if(n.style){var r;i(e.options.cssProps,function(a,o){r=w(n.style,o),t?(e.oldCssProps[r]=n.style[r],n.style[r]=a):n.style[r]=e.oldCssProps[r]||""}),t||(e.oldCssProps={})}}function ue(e,n){var r=t.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=n,n.target.dispatchEvent(r)}var pe,fe=["","webkit","Moz","MS","ms","o"],de=t.createElement("div"),ve="function",he=Math.round,me=Math.abs,ge=Date.now;
pe="function"!=typeof Object.assign?function(e){if(e===r||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(a!==r&&null!==a)for(var o in a)a.hasOwnProperty(o)&&(t[o]=a[o])}return t}:Object.assign;var ye=s(function(e,t,n){for(var a=Object.keys(t),o=0;o<a.length;)(!n||n&&e[a[o]]===r)&&(e[a[o]]=t[a[o]]),o++;return e},"extend","Use `assign`."),_e=s(function(e,t){return ye(e,t,!0)},"merge","Use `assign`."),we=1,be=/mobile|tablet|ip(ad|hone|od)|android/i,xe="ontouchstart"in e,Te=w(e,"PointerEvent")!==r,Ee=xe&&be.test(navigator.userAgent),Ce="touch",Ae="pen",$e="mouse",ke="kinect",Oe=25,Me=1,Se=2,De=4,je=8,Ne=1,Le=2,Ve=4,Pe=8,Ie=16,He=Le|Ve,Fe=Pe|Ie,Re=He|Fe,ze=["x","y"],qe=["clientX","clientY"];T.prototype={handler:function(){},init:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&d(this.element,this.evEl,this.domHandler),this.evTarget&&d(this.target,this.evTarget,this.domHandler),this.evWin&&d(x(this.element),this.evWin,this.domHandler)}};var Be={mousedown:Me,mousemove:Se,mouseup:De},Ye="mousedown",We="mousemove mouseup";l(P,T,{handler:function(e){var t=Be[e.type];t&Me&&0===e.button&&(this.pressed=!0),t&Se&&1!==e.which&&(t=De),this.pressed&&(t&De&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:$e,srcEvent:e}))}});var Ue={pointerdown:Me,pointermove:Se,pointerup:De,pointercancel:je,pointerout:je},Xe={2:Ce,3:Ae,4:$e,5:ke},Ke="pointerdown",Ze="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ke="MSPointerDown",Ze="MSPointerMove MSPointerUp MSPointerCancel"),l(I,T,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),a=Ue[r],o=Xe[e.pointerType]||e.pointerType,i=o==Ce,s=g(t,e.pointerId,"pointerId");a&Me&&(0===e.button||i)?0>s&&(t.push(e),s=t.length-1):a&(De|je)&&(n=!0),0>s||(t[s]=e,this.callback(this.manager,a,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(s,1))}});var Ge={touchstart:Me,touchmove:Se,touchend:De,touchcancel:je},Je="touchstart",Qe="touchstart touchmove touchend touchcancel";l(H,T,{handler:function(e){var t=Ge[e.type];if(t===Me&&(this.started=!0),this.started){var n=F.call(this,e,t);t&(De|je)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:Ce,srcEvent:e})}}});var et={touchstart:Me,touchmove:Se,touchend:De,touchcancel:je},tt="touchstart touchmove touchend touchcancel";l(R,T,{handler:function(e){var t=et[e.type],n=z.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:Ce,srcEvent:e})}});var nt=2500,rt=25;l(q,T,{handler:function(e,t,n){var r=n.pointerType==Ce,a=n.pointerType==$e;if(!(a&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)B.call(this,t,n);else if(a&&W.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var at=w(de.style,"touchAction"),ot=at!==r,it="compute",st="auto",lt="manipulation",ct="none",ut="pan-x",pt="pan-y",ft=K();U.prototype={set:function(e){e==it&&(e=this.compute()),ot&&this.manager.element.style&&ft[e]&&(this.manager.element.style[at]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return i(this.manager.recognizers,function(t){u(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),X(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var r=this.actions,a=h(r,ct)&&!ft[ct],o=h(r,pt)&&!ft[pt],i=h(r,ut)&&!ft[ut];if(a){var s=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(s&&l&&c)return}return i&&o?void 0:a||o&&n&He||i&&n&Fe?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var dt=1,vt=2,ht=4,mt=8,gt=mt,yt=16,_t=32;Z.prototype={defaults:{},set:function(e){return pe(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(o(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=Q(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return o(e,"dropRecognizeWith",this)?this:(e=Q(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(o(e,"requireFailure",this))return this;var t=this.requireFail;return e=Q(e,this),-1===g(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(o(e,"dropRequireFailure",this))return this;e=Q(e,this);var t=g(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){n.manager.emit(t,e)}var n=this,r=this.state;mt>r&&t(n.options.event+G(r)),t(n.options.event),e.additionalEvent&&t(e.additionalEvent),r>=mt&&t(n.options.event+G(r))},tryEmit:function(e){return this.canEmit()?this.emit(e):void(this.state=_t)},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(_t|dt)))return!1;e++}return!0},recognize:function(e){var t=pe({},e);return u(this.options.enable,[this,t])?(this.state&(gt|yt|_t)&&(this.state=dt),this.state=this.process(t),void(this.state&(vt|ht|mt|yt)&&this.tryEmit(t))):(this.reset(),void(this.state=_t))},process:function(e){},getTouchAction:function(){},reset:function(){}},l(ee,Z,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=t&(vt|ht),a=this.attrTest(e);return r&&(n&je||!a)?t|yt:r||a?n&De?t|mt:t&vt?t|ht:vt:_t}}),l(te,ee,{defaults:{event:"pan",threshold:10,pointers:1,direction:Re},getTouchAction:function(){var e=this.options.direction,t=[];return e&He&&t.push(pt),e&Fe&&t.push(ut),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,a=e.direction,o=e.deltaX,i=e.deltaY;return a&t.direction||(t.direction&He?(a=0===o?Ne:0>o?Le:Ve,n=o!=this.pX,r=Math.abs(e.deltaX)):(a=0===i?Ne:0>i?Pe:Ie,n=i!=this.pY,r=Math.abs(e.deltaY))),e.direction=a,n&&r>t.threshold&&a&t.direction},attrTest:function(e){return ee.prototype.attrTest.call(this,e)&&(this.state&vt||!(this.state&vt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=J(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),l(ne,ee,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ct]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&vt)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),l(re,Z,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[st]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,!r||!n||e.eventType&(De|je)&&!o)this.reset();else if(e.eventType&Me)this.reset(),this._timer=a(function(){this.state=gt,this.tryEmit()},t.time,this);else if(e.eventType&De)return gt;return _t},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===gt&&(e&&e.eventType&De?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=ge(),this.manager.emit(this.options.event,this._input)))}}),l(ae,ee,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ct]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&vt)}}),l(oe,ee,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:He|Fe,pointers:1},getTouchAction:function(){return te.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(He|Fe)?t=e.overallVelocity:n&He?t=e.overallVelocityX:n&Fe&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&me(t)>this.options.velocity&&e.eventType&De},emit:function(e){var t=J(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),l(ie,Z,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[lt]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),e.eventType&Me&&0===this.count)return this.failTimeout();if(r&&o&&n){if(e.eventType!=De)return this.failTimeout();var i=this.pTime?e.timeStamp-this.pTime<t.interval:!0,s=!this.pCenter||j(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,s&&i?this.count+=1:this.count=1,this._input=e;var l=this.count%t.taps;if(0===l)return this.hasRequireFailures()?(this._timer=a(function(){this.state=gt,this.tryEmit()},t.interval,this),vt):gt}return _t},failTimeout:function(){return this._timer=a(function(){this.state=_t},this.options.interval,this),_t},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==gt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),se.VERSION="2.0.7",se.defaults={domEvents:!1,touchAction:it,enable:!0,inputTarget:null,inputClass:null,preset:[[ae,{enable:!1}],[ne,{enable:!1},["rotate"]],[oe,{direction:He}],[te,{direction:He},["swipe"]],[ie],[ie,{event:"doubletap",taps:2},["tap"]],[re]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var wt=1,bt=2;le.prototype={set:function(e){return pe(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?bt:wt},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var n,r=this.recognizers,a=t.curRecognizer;(!a||a&&a.state&gt)&&(a=t.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],t.stopped===bt||a&&n!=a&&!n.canRecognizeWith(a)?n.reset():n.recognize(e),!a&&n.state&(vt|ht|mt)&&(a=t.curRecognizer=n),o++}},get:function(e){if(e instanceof Z)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(o(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(o(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=g(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==r&&t!==r){var n=this.handlers;return i(m(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==r){var n=this.handlers;return i(m(e),function(e){t?n[e]&&n[e].splice(g(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&ue(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&ce(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},pe(se,{INPUT_START:Me,INPUT_MOVE:Se,INPUT_END:De,INPUT_CANCEL:je,STATE_POSSIBLE:dt,STATE_BEGAN:vt,STATE_CHANGED:ht,STATE_ENDED:mt,STATE_RECOGNIZED:gt,STATE_CANCELLED:yt,STATE_FAILED:_t,DIRECTION_NONE:Ne,DIRECTION_LEFT:Le,DIRECTION_RIGHT:Ve,DIRECTION_UP:Pe,DIRECTION_DOWN:Ie,DIRECTION_HORIZONTAL:He,DIRECTION_VERTICAL:Fe,DIRECTION_ALL:Re,Manager:le,Input:T,TouchAction:U,TouchInput:R,MouseInput:P,PointerEventInput:I,TouchMouseInput:q,SingleTouchInput:H,Recognizer:Z,AttrRecognizer:ee,Tap:ie,Pan:te,Swipe:oe,Pinch:ne,Rotate:ae,Press:re,on:f,off:d,each:i,merge:_e,extend:ye,assign:pe,inherit:l,bindFn:c,prefixed:w});var xt="undefined"!=typeof e?e:"undefined"!=typeof self?self:{};xt.Hammer=se,"function"==typeof define&&define.amd?define(function(){return se}):"undefined"!=typeof module&&module.exports?module.exports=se:e[n]=se}(window,document,"Hammer"),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.page=e()}}(function(){return function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return a(n?n:e)},u,u.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){(function(n){"use strict";function r(e,t){if("function"==typeof e)return r("*",e);if("function"==typeof t)for(var n=new s(e),a=1;a<arguments.length;++a)r.callbacks.push(n.middleware(arguments[a]));else"string"==typeof e?r["string"==typeof t?"redirect":"show"](e,t):r.start(e)}function a(e){if(!e.handled){var t;t=_?y+h.hash.replace("#!",""):h.pathname+h.search,t!==e.canonicalPath&&(r.stop(),e.handled=!1,h.href=e.canonicalPath)}}function o(e){return"string"!=typeof e?e:g?decodeURIComponent(e.replace(/\+/g," ")):e}function i(e,t){"/"===e[0]&&0!==e.indexOf(y)&&(e=y+(_?"#!":"")+e);var n=e.indexOf("?");if(this.canonicalPath=e,this.path=e.replace(y,"")||"/",_&&(this.path=this.path.replace("#!","")||"/"),this.title=document.title,this.state=t||{},this.state.path=e,this.querystring=~n?o(e.slice(n+1)):"",this.pathname=o(~n?e.slice(0,n):e),this.params={},this.hash="",!_){if(!~this.path.indexOf("#"))return;var r=this.path.split("#");this.path=r[0],this.hash=o(r[1])||"",this.querystring=this.querystring.split("#")[0]}}function s(e,t){t=t||{},this.path="*"===e?"(.*)":e,this.method="GET",this.regexp=p(this.path,this.keys=[],t)}function l(e){if(1===c(e)&&!(e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){for(var t=e.path?e.path[0]:e.target;t&&"A"!==t.nodeName;)t=t.parentNode;if(t&&"A"===t.nodeName&&!t.hasAttribute("download")&&"external"!==t.getAttribute("rel")){var a=t.getAttribute("href");if((_||t.pathname!==h.pathname||!t.hash&&"#"!==a)&&!(a&&a.indexOf("mailto:")>-1)&&!t.target&&u(t.href)){var o=t.pathname+t.search+(t.hash||"");"undefined"!=typeof n&&o.match(/^\/[a-zA-Z]:\//)&&(o=o.replace(/^\/[a-zA-Z]:\//,"/"));var i=o;0===o.indexOf(y)&&(o=o.substr(y.length)),_&&(o=o.replace("#!","")),y&&i===o||(e.preventDefault(),r.show(i))}}}}function c(e){return e=e||window.event,null===e.which?e.button:e.which}function u(e){var t=h.protocol+"//"+h.hostname;return h.port&&(t+=":"+h.port),e&&0===e.indexOf(t)}var p=e("path-to-regexp");t.exports=r;var f,d,v="undefined"!=typeof document&&document.ontouchstart?"touchstart":"click",h="undefined"!=typeof window&&(window.history.location||window.location),m=!0,g=!0,y="",_=!1;r.callbacks=[],r.exits=[],r.current="",r.len=0,r.base=function(e){return 0===arguments.length?y:void(y=e)},r.start=function(e){if(e=e||{},!f&&(f=!0,!1===e.dispatch&&(m=!1),!1===e.decodeURLComponents&&(g=!1),!1!==e.popstate&&window.addEventListener("popstate",w,!1),!1!==e.click&&document.addEventListener(v,l,!1),!0===e.hashbang&&(_=!0),m)){var t=_&&~h.hash.indexOf("#!")?h.hash.substr(2)+h.search:h.pathname+h.search+h.hash;r.replace(t,null,!0,m)}},r.stop=function(){f&&(r.current="",r.len=0,f=!1,document.removeEventListener(v,l,!1),window.removeEventListener("popstate",w,!1))},r.show=function(e,t,n,a){var o=new i(e,t);return r.current=o.path,!1!==n&&r.dispatch(o),!1!==o.handled&&!1!==a&&o.pushState(),o},r.back=function(e,t){r.len>0?(history.back(),r.len--):e?setTimeout(function(){r.show(e,t)}):setTimeout(function(){r.show(y,t)})},r.redirect=function(e,t){"string"==typeof e&&"string"==typeof t&&r(e,function(e){setTimeout(function(){r.replace(t)},0)}),"string"==typeof e&&"undefined"==typeof t&&setTimeout(function(){r.replace(e)},0)},r.replace=function(e,t,n,a){var o=new i(e,t);return r.current=o.path,o.init=n,o.save(),!1!==a&&r.dispatch(o),o},r.dispatch=function(e){function t(){var e=r.exits[s++];return e?void e(o,t):n()}function n(){var t=r.callbacks[i++];return e.path!==r.current?void(e.handled=!1):t?void t(e,n):a(e)}var o=d,i=0,s=0;d=e,o?t():n()},r.exit=function(e,t){if("function"==typeof e)return r.exit("*",e);for(var n=new s(e),a=1;a<arguments.length;++a)r.exits.push(n.middleware(arguments[a]))},r.Context=i,i.prototype.pushState=function(){r.len++,history.pushState(this.state,this.title,_&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},i.prototype.save=function(){history.replaceState(this.state,this.title,_&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},r.Route=s,s.prototype.middleware=function(e){var t=this;return function(n,r){return t.match(n.path,n.params)?e(n,r):void r()}},s.prototype.match=function(e,t){var n=this.keys,r=e.indexOf("?"),a=~r?e.slice(0,r):e,i=this.regexp.exec(decodeURIComponent(a));if(!i)return!1;for(var s=1,l=i.length;l>s;++s){var c=n[s-1],u=o(i[s]);void 0===u&&hasOwnProperty.call(t,c.name)||(t[c.name]=u)}return!0};var w=function(){var e=!1;if("undefined"!=typeof window)return"complete"===document.readyState?e=!0:window.addEventListener("load",function(){setTimeout(function(){e=!0},0)}),function(t){if(e)if(t.state){var n=t.state.path;r.replace(n,t.state)}else r.show(h.pathname+h.hash,void 0,void 0,!1)}}();r.sameOrigin=u}).call(this,e("_process"))},{_process:2,"path-to-regexp":3}],2:[function(e,t,n){function r(){}var a=t.exports={};a.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var r=[];if(t){var a=document.createElement("div"),o=new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})});return o.observe(a,{attributes:!0}),function(e){r.length||a.setAttribute("yes","no"),r.push(e)}}return n?(window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(e){r.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}}(),a.title="browser",a.browser=!0,a.env={},a.argv=[],a.on=r,a.addListener=r,a.once=r,a.off=r,a.removeListener=r,a.removeAllListeners=r,a.emit=r,a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],3:[function(e,t,n){function r(e){for(var t,n=[],r=0,a=0,o="";null!=(t=m.exec(e));){var i=t[0],l=t[1],c=t.index;if(o+=e.slice(a,c),a=c+i.length,l)o+=l[1];else{o&&(n.push(o),o="");var u=t[2],p=t[3],f=t[4],d=t[5],v=t[6],h=t[7],g="+"===v||"*"===v,y="?"===v||"*"===v,_=u||"/",w=f||d||(h?".*":"[^"+_+"]+?");n.push({name:p||r++,prefix:u||"",delimiter:_,optional:y,repeat:g,pattern:s(w)})}}return a<e.length&&(o+=e.substr(a)),o&&n.push(o),n}function a(e){return o(r(e))}function o(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(t[n]=new RegExp("^"+e[n].pattern+"$"));return function(n){for(var r="",a=n||{},o=0;o<e.length;o++){var i=e[o];if("string"!=typeof i){var s,l=a[i.name];if(null==l){if(i.optional)continue;throw new TypeError('Expected "'+i.name+'" to be defined')}if(h(l)){if(!i.repeat)throw new TypeError('Expected "'+i.name+'" to not repeat, but received "'+l+'"');if(0===l.length){if(i.optional)continue;throw new TypeError('Expected "'+i.name+'" to not be empty')}for(var c=0;c<l.length;c++){if(s=encodeURIComponent(l[c]),!t[o].test(s))throw new TypeError('Expected all "'+i.name+'" to match "'+i.pattern+'", but received "'+s+'"');r+=(0===c?i.prefix:i.delimiter)+s}}else{if(s=encodeURIComponent(l),!t[o].test(s))throw new TypeError('Expected "'+i.name+'" to match "'+i.pattern+'", but received "'+s+'"');r+=i.prefix+s}}else r+=i}return r}}function i(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function s(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function l(e,t){return e.keys=t,e}function c(e){return e.sensitive?"":"i"}function u(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return l(e,t)}function p(e,t,n){for(var r=[],a=0;a<e.length;a++)r.push(v(e[a],t,n).source);var o=new RegExp("(?:"+r.join("|")+")",c(n));return l(o,t)}function f(e,t,n){for(var a=r(e),o=d(a,n),i=0;i<a.length;i++)"string"!=typeof a[i]&&t.push(a[i]);return l(o,t)}function d(e,t){t=t||{};for(var n=t.strict,r=t.end!==!1,a="",o=e[e.length-1],s="string"==typeof o&&/\/$/.test(o),l=0;l<e.length;l++){var u=e[l];if("string"==typeof u)a+=i(u);else{var p=i(u.prefix),f=u.pattern;u.repeat&&(f+="(?:"+p+f+")*"),f=u.optional?p?"(?:"+p+"("+f+"))?":"("+f+")?":p+"("+f+")",a+=f}}return n||(a=(s?a.slice(0,-2):a)+"(?:\\/(?=$))?"),a+=r?"$":n&&s?"":"(?=\\/|$)",new RegExp("^"+a,c(t))}function v(e,t,n){return t=t||[],h(t)?n||(n={}):(n=t,t=[]),e instanceof RegExp?u(e,t,n):h(e)?p(e,t,n):f(e,t,n)}var h=e("isarray");t.exports=v,t.exports.parse=r,t.exports.compile=a,t.exports.tokensToFunction=o,t.exports.tokensToRegExp=d;var m=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g")},{isarray:4}],4:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}]},{},[1])(1)});